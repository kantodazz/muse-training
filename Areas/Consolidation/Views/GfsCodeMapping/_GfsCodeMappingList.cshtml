@model IFMIS.Areas.Consolidation.Models.GfsCodeMappingVM
@{
    var i = 0;
}
<style>
    .search-container {
        background-color: white;
        color: black;
        border: 1px solid #ccc;
        border-radius: 4px;
        padding: 3px;
        padding-right: 10px;
        padding-left: 10px;
    }

    input[type=number] {
        padding: 4px;
        border: hidden;
        border-radius: 4px;
    }

    input[type=text] {
        padding: 5px;
        border: 1px solid #ccc;
    }

    input[type=search] {
        padding: 4px;
        border: hidden;
        border-radius: 4px;
    }
</style>

<hr />
<div class="row">

    <div class="col-md-3 col-md-offset-9">
        <div class="search-container" style="float:right">
            <i class="fa fa-search"></i>
            <input type="search" name="search" placeholder="Search..." id="search-box">
        </div>
    </div>
</div>
<table class="table table-bordered table-hover table-condensed" id="dt_items"> 
    <thead>

        <tr>
            <th style="text-align:right">
                #
            </th>

            <th style="text-align:left">
                Name
            </th>
            @foreach (var movement in Model.Movements.OrderBy(a => a.ConsoMovementId))
                {
            <th style="text-align:center">
                @Html.DisplayFor(modelItem => movement.MovementName)
            </th>
                }
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.ComponentsList)
            {
                i++;

        <tr>
            <td style="text-align:right">
                @i
            </td>

            <td style="text-align:left">
                @Html.DisplayFor(modelItem => item.ComponentName)
            </td>
            @foreach (var movement in Model.Movements.OrderBy(a => a.ConsoMovementId))
                    {
        <td style="text-align:center">
            @if (item.GfsCodeList != null)
                            {
                                if (item.GfsCodeList.Any(a => a.ConsoMovementId == movement.ConsoMovementId))
                                {
                                    string gfsCode = item.GfsCodeList.Where(a => a.ConsoMovementId == movement.ConsoMovementId).Select(a => a.GFSCode).FirstOrDefault();
                                    var id = item.GfsCodeList.Where(a => a.ConsoMovementId == movement.ConsoMovementId).Select(a => a.ItemId).FirstOrDefault();
                                   <span><a href="#" onclick="assignGFSCode(@item.ComponentId,@movement.ConsoMovementId,'@item.ComponentName',@id)">@gfsCode</a></span>
                                }
                                else
                                {
                                   <span><a href="#" onclick="assignGFSCode(@item.ComponentId,@movement.ConsoMovementId,'@item.ComponentName',0)">NIL</a></span>
                                }

                            }
                            else
                            {
                                   <span><a href="#" onclick="assignGFSCode(@item.ComponentId,@movement.ConsoMovementId,'@item.ComponentName',0)">NIL</a></span>
                            }

        </td>
                    }

        </tr>
            }
    </tbody>

</table>

<script type="text/javascript">
    var dt_items_data = $('#dt_items').dataTable();
    $("#dt_items_wrapper .dt-toolbar").remove();
    $("#search-box").on("keyup search input paste cut", function () {
        $("#dt_items").DataTable().search(this.value).draw();
    });
   
    $("#GfsCodeId").select2({});
</script>