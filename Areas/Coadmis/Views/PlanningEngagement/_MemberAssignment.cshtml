@model IFMIS.Areas.Coadmis.Models.EngagementVM
<style>
    #myTab5 {
        height: 42px;
    }

    .widget-body1 {
        margin-left: 140px;
        width: 1050px;
    }

    .tabs-below > .nav-tabs, .tabs-left > .nav-tabs, .tabs-right > .nav-tabs {
        border-bottom: 0;
        border-right: 0;
    }

    .form-horizontal {
        margin-top: 30px;
        margin-left: 17px;
    }
</style>

<div class="widget-body1">
    <ul id="myTab5" class="nav nav-tabs bordered">
        <li class="active">
            <a href="#m1" data-toggle="tab" aria-expanded="false">
                <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Assignment
                <span class="badge bg-color-blue txt-color-white"></span>
            </a>
        </li>
        <li class="">
            <a href="#m2" data-toggle="tab" aria-expanded="false">
                <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Sample Size
                <span class="badge bg-color-blue txt-color-white"></span>
            </a>
        </li>
    </ul>
    <div id="myTabContent5" class="tab-content padding-10">
        <div class="tab-pane fade active in" id="m1">
            <div class="form-horizontal">
                <div class="col-xs-12">
                    <div align="center">
                        <img src="~/Media/Images/ajax_loader.gif" class="loadingImg" />
                    </div>
                </div>
                @if (Model.OverallStatus == "Approved")
                {

                }
                else
                {
                    <button type="button" class="btn btn-info" onclick="AddAssignmentAndLeadSchedula()" id="AddAssignmentAndLeadSchedula">
                        <i class="fa fa-plus"></i> Add New
                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                    </button>
                }

                <br />
                <br />
                <div class="col-md-12">
                    <div class="col-md-12">
                        <table id="dt_ebasic" class="table table-striped table-bordered table-hover" width="50%">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    @*<th>Member Full Name</th>
                                        <th>Auditable Area</th>*@
                                    <th style="width: 80%">Auditable Item</th>
                                    <th style="width: 80%">AuditableAreaAssignId</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            @{
                                int s = 0;
                            }
                            <tbody>
                                @if (Model.AssignMemberLeadSch.Count == 0)
                                {
                                    <tr>
                                        <td colspan="5" style="text-align:center">
                                            <span style="font-style:italic">
                                                No Member Assigned Member to This Level in this Engagement :
                                                <strong> @Model.EngagementName</strong>
                                            </span>
                                        </td>
                                    </tr>
                                }
                                else
                                {
                                    foreach (var group in Model.AssignMemberLeadSch.GroupBy(a => a.FullName))
                                    {
                                        <tr bgcolor="lightgrey">
                                            <td colspan="5" style="font-weight:bold;width:600px"> @group.Key </td>
                                        </tr>
                                        foreach (var group2 in group.GroupBy(a => a.AuditableAreaName))
                                        {
                                            <tr bgcolor="lightgrey">
                                                <td colspan="2" style="font-weight:bold;width:600px">@group2.Key</td>
                                                @if (Model.OverallStatus == "Approved")
                                                {

                                                }
                                                else
                                                {
                                                    foreach (var item in group2)
                                                    {
                                                        <td style="font-weight:bold;width:600px">
                                                            <a href="#" onclick="AddAssignedItem('@item.AuditableAreaId', '@item.UserId')">
                                                                <i class="fa fa fa-fw  fa-plus"></i>
                                                            </a>
                                                        </td>
                                                    }

                                                }

                                            </tr>

                                            foreach (var item in group2)
                                            {
                                                s++;
                                                <tr>
                                                    <td>@s</td>
                                                    <td>@item.AuditableItemName</td>
                                                    @if (Model.OverallStatus == "Approved")
                                                    {
                                                        <td colspan="3">
                                                            <a href="#" style="pointer-events:none" onclick="RevokeAssignment(@item.AuditableAreaAssignId)">Disabled</a>
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td colspan="3">
                                                            @*<a href="#" onclick="AddComments(@item.TrendAnalysisId)"><i class="fa fa fa-fw  fa-trash-o"></i></a>|*@
                                                            <a href="#" onclick="RevokeAssignment(@item.AuditableAreaAssignId)"><i class="fa fa fa-fw  fa-trash-o"></i></a>
                                                        </td>
                                                    }

                                                </tr>
                                            }
                                        }
                                    }
                                }

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="m2">
            <div class="form-horizontal">
                <div class="col-xs-12">
                    <div align="center">
                        <img src="~/Media/Images/ajax_loader.gif" class="loadingImg" />
                    </div>
                </div>
                @if (Model.OverallStatus == "Approved")
                {

                }
                else
                {
                    <button type="button" class="btn btn-info" onclick="CalculateSampleSize()" id="CalculateSampleSize">
                        <i class="fa fa-plus"></i> Calculate Sample Size
                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                    </button>
                }

                <br />
                <br />
                <div class="col-md-12">
                    <div class="col-md-12">
                        <table id="dt_samplebasic" class="table table-striped table-bordered table-hover" width="50%">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Auditable Item</th>
                                    <th>Risk Factor</th>
                                    <th>Performance Materiality</th>
                                    <th>Residual Population</th>
                                    <th>Key Item</th>
                                    <th>High Value</th>
                                    <th>Sample Size Residual</th>
                                    <th>Total Sample Size</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            @{
                                int sxj = 0;
                            }
                            <tbody>
                                @if (Model.SamplingInformation.Count == 0)
                                {
                                    <tr>
                                        <td colspan="10" style="text-align:center">
                                            <span style="font-style:italic">
                                                No Data of sampling for :
                                                <strong> @Model.EngagementName</strong>
                                            </span>
                                        </td>
                                    </tr>
                                }
                                else
                                {
                                    foreach (var group in Model.SamplingInformation.GroupBy(a => a.AuditableAreaName))
                                    {
                                        <tr bgcolor="lightgrey">
                                            <td colspan="10" style="font-weight:bold;width:600px"> @group.Key </td>
                                        </tr>

                                        foreach (var item in group)
                                        {
                                            sxj++;
                                            <tr>
                                                <td>@sxj</td>
                                                <td>@item.AuditableItem</td>
                                                <td>@item.RiskFactor</td>
                                                <td>@string.Format("{0:#,0.00}", @item.PerformanceMateriality)</td>
                                                <td>@string.Format("{0:#,0.00}", @item.ResidualPopulation)</td>
                                                <td>@item.KeyItem</td>
                                                <td>@item.HighValue</td>
                                                <td>@item.SampleSize</td>
                                                <td>@string.Format("{0:#,0.00}", @item.TotalSampleSize)</td>
                                                @if (Model.OverallStatus == "Approved")
                                                {
                                                    <td>
                                                        <a href="#" style="pointer-events:none" onclick="DeleteSample(@item.SampleSizeId)">Disabled</a>
                                                        @*<a href="#" onclick="EditSample(@item.SampleSizeId)"><i class="fa fa fa-fw  fa-edit"></i></a>*@
                                                    </td>
                                                }
                                                else
                                                {
                                                    <td>
                                                        <a href="#" onclick="DeleteSample(@item.SampleSizeId)"><i class="fa fa fa-fw  fa-trash-o"></i></a>
                                                        @*<a href="#" onclick="EditSample(@item.SampleSizeId)"><i class="fa fa fa-fw  fa-edit"></i></a>*@
                                                    </td>
                                                }

                                            </tr>
                                        }
                                    }
                                }

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
