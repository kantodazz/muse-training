
@{@model IFMIS.Areas.Coadmis.Models.EngagementVM
ViewBag.Title = "Engagement Assignment";
Layout = "~/Views/Shared/_Layout.cshtml";
}

<style type="text/css">
    .loadingImg {
        display: none;
    }

    tr.group,
    tr.group:hover {
        background-color: #ddd !important;
    }

    body {
        margin-top: 40px;
    }

    .search-btn {
        border: 1px solid #ccc;
        border-radius: 4px;
        padding: 5px;
        padding-right: 10px;
    }

    .search-container {
        display: inline-flex;
        flex: 1 1 300px;
        position: relative;
        border: 1px solid #ccc;
        border-radius: 5px;
        overflow: hidden;
        padding-left: 10px;
    }

    .name-input-container {
        display: inline-flex;
        flex: 1 1 300px;
        position: relative;
        overflow: hidden;
    }

    .search-icon {
        padding: 0.5rem;
    }

    .search-button {
        background: #538AC5;
        border: 0;
        color: white;
        padding: 8px;
        border-radius: 0;
    }

    input[type=number] {
        padding: 8px;
        border: 1px solid #ccc;
        width: 205px;
    }

    input[type=text] {
        padding: 5px;
        border: 1px solid #ccc;
    }

    input[type=search] {
        padding: 4px;
        border: hidden;
        border-radius: 4px;
    }

    textarea {
        border: 1px solid #ccc;
    }

    select {
        padding: 8px;
        border: 1px solid #ccc;
        resize: vertical;
        width: 230px;
    }

    .action-btn {
        width: 100px;
        color: white;
    }

    .form-label {
        text-align: right;
    }

    td {
        padding: 5px;
    }

    .info-box {
        padding: 10px;
        background-color: #ECF3F8;
        text-align: center;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    #itemUL li {
        margin-left: -40px;
        border-bottom: 1px solid silver;
        height: 26px;
        padding-left: 5px;
        padding-top: 8px;
        cursor: pointer;
    }

    .redStar {
        color: red;
        font-size: 15px;
    }

    button#saveAnswerForm {
        margin-left: 90%;
    }

    .swal-modal .swal-text {
        text-align: center;
    }
</style>
<div id="divLoader"></div>
<div id="content" style="margin: 5px; padding-top: 50px">
    <div class="row"></div>
    <!-- widget grid -->
    <section id="widget-grid" class="">
        <div class="row">
            <!-- NEW COL START -->
            <article class="col-sm-12 col-md-12 col-lg-12">

                <!-- Widget ID (each widget will need unique ID)-->
                <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false" data-widget-custombutton="false" data-widget-colorbutton="false" data-widget-deletebutton="false" data-widget-togglebutton="false">

                    <header>
                        <span class="widget-icon"> <i class="fa fa-edit"></i> </span>
                        <h2> @ViewBag.Title</h2>
                    </header>

                    <div class="widget-body">
                        @Html.HiddenFor(model => model.EngagementId)
                        @Html.HiddenFor(model => model.ClientInformationId)
                        @*@ViewBag.PlanningEngagementId*@
                        @*@Html.TextAreaFor(model => model.PlanningEngagementId)*@
                        <div class="alert alert-info fade in">
                            <button class="close" data-dismiss="alert">x</button>
                            <i class="fa-fw fa fa-info"></i>
                            Engagement Name: @Model.EngagementName | @Model.EngagementRefNo
                        </div>
                        <br />
                        <div class="panel-group smart-accordion-default" id="accordion">

                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <div class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" class="collapse" aria-expanded="false">
                                            <i class="fa fa-lg fa-angle-down pull-right"></i>
                                            <i class="fa fa-lg fa-angle-up pull-right"></i>
                                            <i class="fa fa-fw fa-lg fa-folder-o"></i>
                                            General Audit Strategy
                                        </a>
                                    </div>
                                </div>
                                <div id="collapseTwo" class="panel-collapse collapse" aria-expanded="false" style="height: 0px;">
                                    <div class="panel-body">
                                        <div class="widget-body">
                                            <hr class="simple" />
                                            <ul id="myTab2" class="nav nav-tabs bordered">
                                                <li class="active">
                                                    <a href="#sP1" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg fa-question"></i> Understand the Client
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#sP2" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg fa-bank"></i>  Account Estimates
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#sP3" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-sliders"></i> Internal Control
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#sP4" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-sort-numeric-asc"></i>Assess Internal Control Form
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#sP5" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-sort-numeric-asc"></i>General Int. Control Questionnaire
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                            </ul>
                                            <div id="myTabContent2" class="tab-content padding-10">
                                                <div class="tab-pane fade active in" id="sP1">
                                                    <div class="col-md-12">
                                                        @if (Model.QuestionnairToAnswers.Count != 0)
                                                        {
                                                            <div class="col-md-12">
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt><strong>Client Name:</strong></dt>
                                                                        <dd>@ViewBag.ClientName</dd>
                                                                        <dt><strong>File No.:</strong></dt>
                                                                        <dd>@ViewBag.FileNo</dd>
                                                                        <dt> <strong>Working Paper Ref:</strong></dt>
                                                                        <dd> @ViewBag.WorkPaper</dd>
                                                                    </dl>
                                                                </div>
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt>Questionnaire Title</dt>
                                                                        <dd>Understand Client and It's Environments'</dd>
                                                                        <dt><strong>Prepared By:</strong></dt>
                                                                        <dd>@ViewBag.PreparedBy</dd>
                                                                        <dt><strong>Prepared At:</strong></dt>
                                                                        <dd>@ViewBag.PreparedAt</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                        }

                                                        @if (Model.QuestionnairToAnswers.Count == 0)
                                                        {
                                                            <div class="row">
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                                <div class="col-lg-6 col-sm-6 col-xs-6">

                                                                    <div class="alert alert-block alert-info">
                                                                        <a class="close" data-dismiss="alert" href="#">×</a>
                                                                        <center><span>Understanding The Client And Its Environment is not Assigned for this Year</span></center>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                            </div>
                                                        }

                                                        @if (Model.QuestionnairToAnswers.Count != 0 && ViewBag.IsUnderstandQuestAns == false)
                                                        {
                                                            /*BEGIN ADDING QUESTIONNAIRE ANSWERS*/
                                                            using (Html.BeginForm("SaveQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Understanding The Client And Its Environment" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0; }
                                                                        @foreach (var group in Model.QuestionnairToAnswers.GroupBy(a => a.QuestionnairTitleName))
                                                                        {
                                                                            n++;
                                                                            <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                <td colspan="13">
                                                                                    <strong>
                                                                                        <span class="sign"></span>
                                                                                        @n. @group.Key
                                                                                    </strong>
                                                                                </td>
                                                                            </tr>

                                                                            int y = 0;

                                                                            int num = 0;

                                                                            foreach (var item in group.GroupBy(a => a.Question))
                                                                            {
                                                                                num++;
                                                                                <tr>
                                                                                    <td>@item.Key </td>
                                                                                    @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                    {

                                                                                        foreach (var data in itemx)
                                                                                        {
                                                                                            y++;

                                                                                            if (itemx.Key == "Radio Button")
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                </td>
                                                                                            }

                                                                                            else if (itemx.Key == "Text")
                                                                                            {
                                                                                                <td>
                                                                                                    <label>@data.Value</label>
                                                                                                    <input type="hidden" id="QuestionIdForTextAreas-@y" name="QuestionIdForTextAreas[]" value="@item.Select(a => a.QuestionId).FirstOrDefault()" />
                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]"></textarea>
                                                                                                </td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@y" />
                                                                                                    <label>@data.Value</label>
                                                                                                </td>
                                                                                            }
                                                                                        }
                                                                                    }

                                                                                </tr>
                                                                            }

                                                                        }

                                                                    </tbody>
                                                                </table>

                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>

                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>

                                                                </div>
                                                            }
                                                            /*END ADDING QUESTIONNAIRE ANSWERS*/
                                                        }

                                                        @if (ViewBag.IsUnderstandQuestAns)
                                                        {
                                                            using (Html.BeginForm("UpdateQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Understanding The Client And Its Environment" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0;
                                                                        }
                                                                        @if (Model.QuestionnairToAnswers != null)
                                                                        {
                                                                            foreach (var group in Model.QuestionnairToAnswers.GroupBy(a => a.QuestionnairTitleName))
                                                                            {
                                                                                n++;
                                                                                <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                    <td colspan="13">
                                                                                        <strong>
                                                                                            <span class="sign"></span>
                                                                                            @n. @group.Key
                                                                                        </strong>
                                                                                    </td>
                                                                                </tr>

                                                                                int y = 0;

                                                                                int num = 0;

                                                                                foreach (var item in group.GroupBy(a => a.Question))
                                                                                {
                                                                                    num++;
                                                                                    <tr>
                                                                                        <td>@item.Key </td>
                                                                                        @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                        {

                                                                                            foreach (var data in itemx)
                                                                                            {
                                                                                                y++;

                                                                                                if (ViewBag.GetUnderstandQuestAnswers != null)
                                                                                                {

                                                                                                    for (var nm = 0; nm < ViewBag.GetUnderstandQuestAnswers.Count; nm++)
                                                                                                    {
                                                                                                        if (ViewBag.GetUnderstandQuestAnswers[nm].QuestionId == @item.Select(a => a.QuestionId).FirstOrDefault())
                                                                                                        {

                                                                                                            if (itemx.Key == "Radio Button")
                                                                                                            {

                                                                                                                if (ViewBag.GetUnderstandQuestAnswers[nm].Answer == data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetUnderstandQuestAnswers[nm].Answer-@ViewBag.GetUnderstandQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                                else if (ViewBag.GetUnderstandQuestAnswers[nm].Answer != data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetUnderstandQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                            }
                                                                                                            else if (itemx.Key == "Text")
                                                                                                            {
                                                                                                                <td>
                                                                                                                    <label>@data.Value</label>
                                                                                                                    <input type="hidden" id="QuestionIdForTxtAreas-@y" name="QuestionIdForTxtAreas[]" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetUnderstandQuestAnswers[nm].QuestionnaireAnswerDetailId" />
                                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]">@ViewBag.GetUnderstandQuestAnswers[nm].Answer</textarea>
                                                                                                                </td>
                                                                                                            }
                                                                                                            else
                                                                                                            {

                                                                                                                if (ViewBag.GetUnderstandQuestAnswers[nm].Answer.Contains(","))
                                                                                                                {
                                                                                                                    string[] answerArray = ViewBag.GetUnderstandQuestAnswers[nm].Answer.Split(',');

                                                                                                                    <td>
                                                                                                                        @for (var z = 0; z < answerArray.Count(); z++)
                                                                                                                        {
                                                                                                                            if (answerArray[z] == data.Value)
                                                                                                                            {
                                                                                                                                <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@answerArray[z]-@ViewBag.GetUnderstandQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                                <label>@data.Value</label>
                                                                                                                            }
                                                                                                                        }
                                                                                                                        @if (!answerArray.Contains(data.Value))
                                                                                                                        {
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetUnderstandQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        }

                                                                                                                    </td>
                                                                                                                }
                                                                                                                else
                                                                                                                {
                                                                                                                    if (ViewBag.GetUnderstandQuestAnswers[nm].Answer == data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" checked value="@item.Select(a => a.QuestionId).FirstOrDefault()_@ViewBag.GetUnderstandQuestAnswers[nm].Answer-@ViewBag.GetUnderstandQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                    else if (ViewBag.GetUnderstandQuestAnswers[nm].Answer != data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetUnderstandQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                }
                                                                                                            }
                                                                                                        }
                                                                                                    }


                                                                                                }
                                                                                            }
                                                                                        }

                                                                                    </tr>
                                                                                }

                                                                            }
                                                                        }

                                                                    </tbody>
                                                                </table>
                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>
                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>
                                                                </div>
                                                            }
                                                        }

                                                    </div>
                                                </div>

                                                <div class="tab-pane fade" id="sP2">
                                                    <form>
                                                        <div class="form-horizontal">
                                                            <div class="col-xs-12">
                                                                <div align="center">
                                                                    <img src="~/Media/Images/ajax_loader.gif" class="loadingImg" />
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <div class="col-md-12">
                                                                    <div class="col-md-2">
                                                                        <button type="button" class="btn btn-info" onclick="AddAccountEstimate()" id="addAccountEstimate">
                                                                            <i class="fa fa-plus"></i> Add New
                                                                            <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <div class="col-md-12">
                                                                    <div class="col-md-12">
                                                                        <table id="dt_ebasic" class="table table-striped table-bordered table-hover" width="50%">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th>#</th>
                                                                                    <th>Account Estimate</th>
                                                                                    <th>Previous Amount(Tsh)</th>
                                                                                    <th>Current Amount(Tsh)</th>
                                                                                    <th>Method</th>
                                                                                    <th>Estimation Uncertainty</th>
                                                                                    <th>Overall Assessment</th>
                                                                                    <th>Audit Approach</th>
                                                                                    <th>Action</th>
                                                                                </tr>
                                                                            </thead>
                                                                            @{
                                                                                int xj = 0;
                                                                            }
                                                                            <tbody>
                                                                                @if (Enumerable.Count(ViewBag.ReviewAccountEstimate) == 0)
                                                                                {
                                                                                    <tr>
                                                                                        <td colspan="7" style="text-align:center">
                                                                                            <span style="font-style:italic">
                                                                                                No Estimate Registered For this:
                                                                                                <strong> @Model.EngagementName</strong>
                                                                                            </span>
                                                                                        </td>
                                                                                    </tr>
                                                                                }
                                                                                else
                                                                                {
                                                                                    foreach (var item in ViewBag.ReviewAccountEstimate)
                                                                                    {

                                                                                        xj++;
                                                                                        <tr>
                                                                                            <td>@xj</td>
                                                                                            <td>@item.AccountEstimateName</td>
                                                                                            <td style="text-align:right">@string.Format("{0:#,0.00}", @item.PreYearAmount)</td>
                                                                                            <td style="text-align:right">@string.Format("{0:#,0.00}", @item.CurYearAmount)</td>
                                                                                            <td>@item.Method</td>
                                                                                            <td>@item.DegreeOfestimationncertainty</td>
                                                                                            <td>@item.OverallRiskAssessment</td>
                                                                                            <td>@item.AuditApproach</td>
                                                                                            <td width="70px">
                                                                                                <a href="#" onclick="RemoveAccountEst(@item.AccountEstimatePerFyId)"><i class="fa fa fa-fw  fa-trash-o"></i></a>|
                                                                                                <a href="#" onclick="EditAccountEst(@item.AccountEstimatePerFyId)"><i class="fa fa fa-fw  fa-pencil-square-o"></i></a>
                                                                                            </td>
                                                                                        </tr>
                                                                                    }
                                                                                }

                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                                <div class="tab-pane fade" id="sP3">
                                                    <div class="form-group">
                                                        <div class="col-md-12">
                                                            <div class="col-md-12">
                                                                <table id="dt_RevIntbasic" class="table table-striped table-bordered table-hover" width="50%">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>#</th>
                                                                            <th>Business Area</th>
                                                                            <th>Control Name</th>
                                                                            <th>Design Internal Control</th>
                                                                            <th>Implementation Control</th>
                                                                            <th>Is Key Control</th>
                                                                            <th>Require Further Test</th>
                                                                            <th>ICE Ref</th>
                                                                            <th>Status</th>
                                                                            <th>Action</th>
                                                                        </tr>
                                                                    </thead>
                                                                    @{
                                                                        int su = 0;
                                                                        string iskeycontrol;
                                                                        string isfurtherTest;
                                                                        string impControl;
                                                                    }
                                                                    <tbody>
                                                                        @if (Enumerable.Count(ViewBag.ReviewInternalControl) == 0)
                                                                        {
                                                                            <tr>
                                                                                <td colspan="10" style="text-align:center">
                                                                                    <span style="font-style:italic">
                                                                                        No Data Mapping at the Permanent File
                                                                                        <strong> @Model.EngagementName</strong>
                                                                                    </span>
                                                                                </td>
                                                                            </tr>
                                                                        }
                                                                        else
                                                                        {
                                                                            foreach (var item in ViewBag.ReviewInternalControl)
                                                                            {

                                                                                su++;
                                                                                <tr>
                                                                                    <td>@su</td>
                                                                                    <td>@item.BusinessAreaName</td>
                                                                                    <td>@item.ControlName</td>
                                                                                    <td>@item.DesignControl</td>
                                                                                    <td>
                                                                                        @if (@item.ImpControl == "NA")
                                                                                        {
                                                                                            impControl = "";
                                                                                            @impControl;
                                                                                        }
                                                                                        else if (@item.ImpControl != "NA")
                                                                                        {
                                                                                            @item.ImpControl
                                                                                        }
                                                                                    <td>
                                                                                        @if (@item.isKeyControl == false)
                                                                                        {
                                                                                            iskeycontrol = "";
                                                                                            @iskeycontrol;
                                                                                        }
                                                                                        else if (item.isKeyControl == true)
                                                                                        {
                                                                                            iskeycontrol = "Yes";
                                                                                            @iskeycontrol;
                                                                                        }
                                                                                    </td>
                                                                                    <td>
                                                                                        @if (@item.isFurtherTest == false)
                                                                                        {
                                                                                            isfurtherTest = "";
                                                                                            @isfurtherTest;
                                                                                        }
                                                                                        else if (item.isFurtherTest == true)
                                                                                        {
                                                                                            isfurtherTest = "Yes";
                                                                                            @isfurtherTest;
                                                                                        }
                                                                                    </td>
                                                                                    <td>@item.RefICE</td>
                                                                                    <td>
                                                                                        @if (@item.Status == "Not Reviewed")
                                                                                        {
                                                                                            <span class="label label-warning">@item.Status</span>
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <span class="label label-success">@item.Status</span>
                                                                                        }


                                                                                    </td>
                                                                                    <td width="40px">
                                                                                        <a href="#" onclick="ReviewInternalControl(@item.InternalControlId)"><i class="fa fa fa-fw  fa-pencil-square-o"></i></a>
                                                                                    </td>
                                                                                </tr>
                                                                            }
                                                                        }

                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="sP4">
                                                    <div class="col-md-12">
                                                        @if (Model.InternalControFormQn.Count != 0)
                                                        {
                                                            <div class="col-md-12">
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt><strong>Client Name:</strong></dt>
                                                                        <dd>@ViewBag.ClientNameIntCont</dd>
                                                                        <dt><strong>File No.:</strong></dt>
                                                                        <dd>@ViewBag.FileNo</dd>
                                                                        <dt> <strong>Working Paper Ref:</strong></dt>
                                                                        <dd> @ViewBag.WorkPaperIntCont</dd>
                                                                    </dl>
                                                                </div>
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt>Questionnaire Title</dt>
                                                                        <dd>Internal Control Questionnaire</dd>
                                                                        <dt><strong>Prepared By:</strong></dt>
                                                                        <dd>@ViewBag.PreparedByIntCont</dd>
                                                                        <dt><strong>Prepared At:</strong></dt>
                                                                        <dd>@ViewBag.PreparedAtIntCont</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                        }
                                                        @if (Model.InternalControFormQn.Count == 0)
                                                        {
                                                            <div class="row">
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                                <div class="col-lg-6 col-sm-6 col-xs-6">

                                                                    <div class="alert alert-block alert-info">
                                                                        <a class="close" data-dismiss="alert" href="#">×</a>
                                                                        <center><span>Internal Control Questionnaire is not Assigned for this Year</span></center>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                            </div>
                                                        }

                                                        @if (Model.InternalControFormQn.Count != 0 && ViewBag.IsInternalControlAns == false)
                                                        {
                                                            /*BEGIN ADDING QUESTIONNAIRE ANSWERS*/
                                                            using (Html.BeginForm("SaveQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Internal Control Questionnaire" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0; }
                                                                        @foreach (var group in Model.InternalControFormQn.GroupBy(a => a.QuestionnairTitleName))
                                                                        {
                                                                            n++;
                                                                            <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                <td colspan="13">
                                                                                    <strong>
                                                                                        <span class="sign"></span>
                                                                                        @n. @group.Key
                                                                                    </strong>
                                                                                </td>
                                                                            </tr>

                                                                            int y = 0;

                                                                            int num = 0;

                                                                            foreach (var item in group.GroupBy(a => a.Question))
                                                                            {
                                                                                num++;
                                                                                <tr>
                                                                                    <td>@item.Key </td>
                                                                                    @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                    {

                                                                                        foreach (var data in itemx)
                                                                                        {
                                                                                            y++;

                                                                                            if (itemx.Key == "Radio Button")
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                </td>
                                                                                            }

                                                                                            else if (itemx.Key == "Text")
                                                                                            {
                                                                                                <td>
                                                                                                    <label>@data.Value</label>
                                                                                                    <input type="hidden" id="QuestionIdForTextAreas-@y" name="QuestionIdForTextAreas[]" value="@item.Select(a => a.QuestionId).FirstOrDefault()" />
                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]"></textarea>
                                                                                                </td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@y" />
                                                                                                    <label>@data.Value</label>
                                                                                                </td>
                                                                                            }
                                                                                        }
                                                                                    }

                                                                                </tr>
                                                                            }

                                                                        }

                                                                    </tbody>
                                                                </table>

                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>

                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>

                                                                </div>
                                                            }
                                                            /*END ADDING QUESTIONNAIRE ANSWERS*/
                                                        }

                                                        @if (ViewBag.IsInternalControlAns)
                                                        {
                                                            using (Html.BeginForm("UpdateQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Internal Control Questionnaire" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0;
                                                                        }
                                                                        @if (Model.InternalControFormQn != null)
                                                                        {
                                                                            foreach (var group in Model.InternalControFormQn.GroupBy(a => a.QuestionnairTitleName))
                                                                            {
                                                                                n++;
                                                                                <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                    <td colspan="13">
                                                                                        <strong>
                                                                                            <span class="sign"></span>
                                                                                            @n. @group.Key
                                                                                        </strong>
                                                                                    </td>
                                                                                </tr>

                                                                                int y = 0;

                                                                                int num = 0;

                                                                                foreach (var item in group.GroupBy(a => a.Question))
                                                                                {
                                                                                    num++;
                                                                                    <tr>
                                                                                        <td>@item.Key </td>
                                                                                        @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                        {

                                                                                            foreach (var data in itemx)
                                                                                            {
                                                                                                y++;

                                                                                                if (ViewBag.GetInternalControlQuestAnswers != null)
                                                                                                {
                                                                                                    for (var nm = 0; nm < ViewBag.GetInternalControlQuestAnswers.Count; nm++)
                                                                                                    {
                                                                                                        if (ViewBag.GetInternalControlQuestAnswers[nm].QuestionId == @item.Select(a => a.QuestionId).FirstOrDefault())
                                                                                                        {

                                                                                                            if (itemx.Key == "Radio Button")
                                                                                                            {

                                                                                                                if (ViewBag.GetInternalControlQuestAnswers[nm].Answer == data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetInternalControlQuestAnswers[nm].Answer-@ViewBag.GetInternalControlQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                                else if (ViewBag.GetInternalControlQuestAnswers[nm].Answer != data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetInternalControlQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                            }
                                                                                                            else if (itemx.Key == "Text")
                                                                                                            {
                                                                                                                <td>
                                                                                                                    <label>@data.Value</label>
                                                                                                                    <input type="hidden" id="QuestionIdForTxtAreas-@y" name="QuestionIdForTxtAreas[]" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetInternalControlQuestAnswers[nm].QuestionnaireAnswerDetailId" />
                                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]">@ViewBag.GetInternalControlQuestAnswers[nm].Answer</textarea>
                                                                                                                </td>
                                                                                                            }
                                                                                                            else
                                                                                                            {

                                                                                                                if (ViewBag.GetInternalControlQuestAnswers[nm].Answer.Contains(","))
                                                                                                                {
                                                                                                                    string[] answerArray = ViewBag.GetInternalControlQuestAnswers[nm].Answer.Split(',');

                                                                                                                    <td>
                                                                                                                        @for (var z = 0; z < answerArray.Count(); z++)
                                                                                                                        {
                                                                                                                            if (answerArray[z] == data.Value)
                                                                                                                            {
                                                                                                                                <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@answerArray[z]-@ViewBag.GetInternalControlQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                                <label>@data.Value</label>
                                                                                                                            }
                                                                                                                        }
                                                                                                                        @if (!answerArray.Contains(data.Value))
                                                                                                                        {
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetInternalControlQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        }

                                                                                                                    </td>
                                                                                                                }
                                                                                                                else
                                                                                                                {
                                                                                                                    if (ViewBag.GetInternalControlQuestAnswers[nm].Answer == data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" checked value="@item.Select(a => a.QuestionId).FirstOrDefault()_@ViewBag.GetInternalControlQuestAnswers[nm].Answer-@ViewBag.GetInternalControlQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                    else if (ViewBag.GetInternalControlQuestAnswers[nm].Answer != data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetInternalControlQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                }
                                                                                                            }
                                                                                                        }
                                                                                                    }
                                                                                                }


                                                                                            }
                                                                                        }

                                                                                    </tr>
                                                                                }

                                                                            }
                                                                        }

                                                                    </tbody>
                                                                </table>
                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>
                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>
                                                                </div>
                                                            }
                                                        }

                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="sP5">
                                                    <div class="col-md-12">
                                                        @if (Model.GeneralInterControQn.Count != 0)
                                                        {
                                                            <div class="col-md-12">
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt><strong>Client Name:</strong></dt>
                                                                        <dd>@ViewBag.ClientNameIntCont</dd>
                                                                        <dt><strong>File No.:</strong></dt>
                                                                        <dd>@ViewBag.FileNo</dd>
                                                                        <dt> <strong>Working Paper Ref:</strong></dt>
                                                                        <dd> @ViewBag.WorkPaperIntCont</dd>
                                                                    </dl>
                                                                </div>
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt>Questionnaire Title</dt>
                                                                        <dd>General Internal Control Questionnaire</dd>
                                                                        <dt><strong>Prepared By:</strong></dt>
                                                                        <dd>@ViewBag.PreparedByIntCont</dd>
                                                                        <dt><strong>Prepared At:</strong></dt>
                                                                        <dd>@ViewBag.PreparedAtIntCont</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                        }
                                                        @if (Model.GeneralInterControQn.Count == 0)
                                                        {
                                                            <div class="row">
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                                <div class="col-lg-6 col-sm-6 col-xs-6">

                                                                    <div class="alert alert-block alert-info">
                                                                        <a class="close" data-dismiss="alert" href="#">×</a>
                                                                        <center><span>General Internal Questionnaire is not Assigned for this Year</span></center>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                            </div>
                                                        }
                                                        @if (Model.GeneralInterControQn.Count != 0 && ViewBag.IsGeneralIntControlAns == false)
                                                        {
                                                            /*BEGIN ADDING QUESTIONNAIRE ANSWERS*/
                                                            using (Html.BeginForm("SaveQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="General Internal Questionnaire" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0; }
                                                                        @foreach (var group in Model.GeneralInterControQn.GroupBy(a => a.QuestionnairTitleName))
                                                                        {
                                                                            n++;
                                                                            <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                <td colspan="13">
                                                                                    <strong>
                                                                                        <span class="sign"></span>
                                                                                        @n. @group.Key
                                                                                    </strong>
                                                                                </td>
                                                                            </tr>

                                                                            int y = 0;

                                                                            int num = 0;

                                                                            foreach (var item in group.GroupBy(a => a.Question))
                                                                            {
                                                                                num++;
                                                                                <tr>
                                                                                    <td>@item.Key </td>
                                                                                    @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                    {

                                                                                        foreach (var data in itemx)
                                                                                        {
                                                                                            y++;

                                                                                            if (itemx.Key == "Radio Button")
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                </td>
                                                                                            }

                                                                                            else if (itemx.Key == "Text")
                                                                                            {
                                                                                                <td>
                                                                                                    <label>@data.Value</label>
                                                                                                    <input type="hidden" id="QuestionIdForTextAreas-@y" name="QuestionIdForTextAreas[]" value="@item.Select(a => a.QuestionId).FirstOrDefault()" />
                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]"></textarea>
                                                                                                </td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@y" />
                                                                                                    <label>@data.Value</label>
                                                                                                </td>
                                                                                            }
                                                                                        }
                                                                                    }

                                                                                </tr>
                                                                            }

                                                                        }

                                                                    </tbody>
                                                                </table>

                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>

                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>

                                                                </div>
                                                            }
                                                            /*END ADDING QUESTIONNAIRE ANSWERS*/
                                                        }
                                                        @if (ViewBag.IsGeneralIntControlAns)
                                                        {
                                                            using (Html.BeginForm("UpdateQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="General Internal Questionnaire" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0;
                                                                        }
                                                                        @if (Model.GeneralInterControQn != null)
                                                                        {
                                                                            foreach (var group in Model.GeneralInterControQn.GroupBy(a => a.QuestionnairTitleName))
                                                                            {
                                                                                n++;
                                                                                <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                    <td colspan="13">
                                                                                        <strong>
                                                                                            <span class="sign"></span>
                                                                                            @n. @group.Key
                                                                                        </strong>
                                                                                    </td>
                                                                                </tr>

                                                                                int y = 0;

                                                                                int num = 0;

                                                                                foreach (var item in group.GroupBy(a => a.Question))
                                                                                {
                                                                                    num++;
                                                                                    <tr>
                                                                                        <td>@item.Key </td>
                                                                                        @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                        {

                                                                                            foreach (var data in itemx)
                                                                                            {
                                                                                                y++;

                                                                                                if (ViewBag.GetGeneralIntControlQuestAnswers != null)
                                                                                                {

                                                                                                    for (var nm = 0; nm < ViewBag.GetGeneralIntControlQuestAnswers.Count; nm++)
                                                                                                    {
                                                                                                        if (ViewBag.GetGeneralIntControlQuestAnswers[nm].QuestionId == @item.Select(a => a.QuestionId).FirstOrDefault())
                                                                                                        {

                                                                                                            if (itemx.Key == "Radio Button")
                                                                                                            {

                                                                                                                if (ViewBag.GetGeneralIntControlQuestAnswers[nm].Answer == data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" checked value="@item.Select(a => a.QuestionId).FirstOrDefault()_@ViewBag.GetGeneralIntControlQuestAnswers[nm].Answer-@ViewBag.GetGeneralIntControlQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                                else if (ViewBag.GetGeneralIntControlQuestAnswers[nm].Answer != data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetGeneralIntControlQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                            }
                                                                                                            else if (itemx.Key == "Text")
                                                                                                            {
                                                                                                                <td>
                                                                                                                    <label>@data.Value</label>
                                                                                                                    <input type="hidden" id="QuestionIdForTxtAreas-@y" name="QuestionIdForTxtAreas[]" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@ViewBag.GetGeneralIntControlQuestAnswers[nm].QuestionnaireAnswerDetailId" />
                                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]">@ViewBag.GetGeneralIntControlQuestAnswers[nm].Answer</textarea>
                                                                                                                </td>
                                                                                                            }
                                                                                                            else
                                                                                                            {

                                                                                                                if (ViewBag.GetGeneralIntControlQuestAnswers[nm].Answer.Contains(","))
                                                                                                                {
                                                                                                                    string[] answerArray = ViewBag.GetGeneralIntControlQuestAnswers[nm].Answer.Split(',');

                                                                                                                    <td>
                                                                                                                        @for (var z = 0; z < answerArray.Count(); z++)
                                                                                                                        {
                                                                                                                            if (answerArray[z] == data.Value)
                                                                                                                            {
                                                                                                                                <input type="checkbox" class="answers" checked value="@item.Select(a => a.QuestionId).FirstOrDefault()_@answerArray[z]-@ViewBag.GetUnderstandQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                                <label>@data.Value</label>
                                                                                                                            }
                                                                                                                        }
                                                                                                                        @if (!answerArray.Contains(data.Value))
                                                                                                                        {
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetUnderstandQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        }

                                                                                                                    </td>
                                                                                                                }
                                                                                                                else
                                                                                                                {
                                                                                                                    if (ViewBag.GetGeneralIntControlQuestAnswers[nm].Answer == data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" checked value="@item.Select(a => a.QuestionId).FirstOrDefault()_@ViewBag.GetUnderstandQuestAnswers[nm].Answer-@ViewBag.GetUnderstandQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                    else if (ViewBag.GetGeneralIntControlQuestAnswers[nm].Answer != data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetUnderstandQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                }
                                                                                                            }
                                                                                                        }
                                                                                                    }
                                                                                                }

                                                                                            }
                                                                                        }

                                                                                    </tr>
                                                                                }

                                                                            }
                                                                        }

                                                                    </tbody>
                                                                </table>
                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>
                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>
                                                                </div>
                                                            }
                                                        }

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <div class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" class="collapse" aria-expanded="false">
                                            <i class="fa fa-lg fa-angle-down pull-right"></i>
                                            <i class="fa fa-lg fa-angle-up pull-right"></i>
                                            <i class="fa fa-fw fa-lg fa-circle-o-notch"></i>
                                            Preliminary Analytical Procedure
                                        </a>
                                    </div>
                                </div>
                                <div id="collapseThree" class="panel-collapse collapse" aria-expanded="false" style="height: 0px;">
                                    <div class="panel-body">
                                        <div class="widget-body">
                                            <hr class="simple" />
                                            <ul id="myTab3" class="nav nav-tabs bordered">
                                                <li class="active">
                                                    <a href="#sF1" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg fa-stack-exchange"></i> Note To Account
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#sF2" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg fa-minus-square"></i> Analysis & Movement
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#sF3" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg fa-question"></i> Preliminary Analytical Procedures
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>

                                            </ul>
                                            <div id="myTabContent3" class="tab-content padding-10">
                                                <div class="tab-pane fade active in" id="sF1">

                                                    <form>
                                                        <div class="form-horizontal">
                                                            <div class="col-xs-12">
                                                                <div align="center">
                                                                    <img src="~/Media/Images/ajax_loader.gif" class="loadingImg" />
                                                                </div>
                                                                <div class="col-md-12">

                                                                    <table id="dt_ebasic" class="table table-striped table-bordered table-hover" width="50%">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>#</th>
                                                                                <th>Auditable Area</th>
                                                                                <th>Action</th>
                                                                            </tr>
                                                                        </thead>
                                                                        @{
                                                                            int jj = 0;
                                                                        }
                                                                        <tbody>
                                                                            @if (Enumerable.Count(ViewBag.AuditableAreaAssign) == 0)
                                                                            {
                                                                                <tr>
                                                                                    <td colspan="3" style="text-align:center">
                                                                                        <span style="font-style:italic">
                                                                                            No Note To Accounts Assignment To This:
                                                                                            <strong> @Model.EngagementName</strong>
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            }
                                                                            else
                                                                            {
                                                                                foreach (var item in ViewBag.AuditableAreaAssign)
                                                                                {

                                                                                    jj++;
                                                                                    <tr>
                                                                                        <td>@jj</td>
                                                                                        <td>@item.AuditableAreaName</td>
                                                                                        @*<td><a href="#" onclick="AddNoteToAccount('@item.FinancialYearName')"><i class="fa fa fa-fw  fa-usd"></i>Note To Accounts</a></td>*@
                                                                                        <td><a href="#" onclick="AddNoteToAccount(@item.AuditableAreaId,'@item.FinancialYearName')"><i class="fa fa fa-fw  fa-usd"></i>Note To Accounts</a></td>
                                                                                    </tr>
                                                                                }
                                                                            }

                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                                <div class="tab-pane fade" id="sF2">

                                                    <form>
                                                        <div class="form-horizontal">
                                                            <div class="col-xs-12">
                                                                <div align="center">
                                                                    <img src="~/Media/Images/ajax_loader.gif" class="loadingImg" />
                                                                </div>

                                                                <div class="form-group">
                                                                    <div class="col-md-3">
                                                                        <button type="button" class="btn btn-info" id="generateTrendsMovement">
                                                                            <i class="fa  fa-gears"></i>  Generate Trends Analysis
                                                                            <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                        </button>
                                                                    </div>

                                                                </div>

                                                                <div class="col-md-12">

                                                                    <table id="dt_trendAnalysisBasic" class="table table-striped table-bordered table-hover" width="50%">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>#</th>
                                                                                <th>Auditable Area</th>
                                                                                <th>Previous Amount(Tsh)</th>
                                                                                <th>Current Amount(Tsh)</th>
                                                                                <th>Movement</th>
                                                                                <th>Trend</th>
                                                                                <th>Percatage(%)</th>
                                                                                <th>Action</th>
                                                                            </tr>
                                                                        </thead>
                                                                        @{
                                                                            int jX = 0;
                                                                        }
                                                                        <tbody>
                                                                            @if (Model.AuditAssignmnet.Count == 0)
                                                                            {
                                                                                <tr>
                                                                                    <td colspan="7" style="text-align:center">
                                                                                        <span style="font-style:italic">
                                                                                            No data to Analysed, Please process Note to Account Before Proceed to This Level in this Engagement :
                                                                                            <strong> @Model.EngagementName</strong>
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            }
                                                                            else
                                                                            {
                                                                                foreach (var group in Model.AuditAssignmnet.GroupBy(a => a.AuditableAreaName))
                                                                                {
                                                                                    <tr bgcolor="lightgrey">
                                                                                        <td colspan="7" style="font-weight:bold;width:600px"> @group.Key </td>
                                                                                    </tr>

                                                                                    foreach (var item in group)
                                                                                    {
                                                                                        jX++;
                                                                                        <tr>
                                                                                            <td>@jX</td>
                                                                                            <td>@item.AuditableItemName: @item.Description</td>
                                                                                            <td style="text-align:right"> @string.Format("{0:#,0.00}", @item.PreviousYearAmount)</td>
                                                                                            <td style="text-align:right">@string.Format("{0:#,0.00}", @item.CurrentYearAmount)</td>
                                                                                            <td style="text-align:right"> @string.Format("{0:#,0.00}", @item.Movement)</td>
                                                                                            <td>@item.Trend</td>
                                                                                            <td style="text-align:right">@item.PercategeChange %</td>
                                                                                            <td><a href="#" onclick="AddComments(@item.TrendAnalysisId)"><i class="fa fa fa-fw  fa-commenting-o"></i>Add Comments</a></td>
                                                                                        </tr>
                                                                                    }

                                                                                }
                                                                            }

                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>

                                                </div>
                                                <div class="tab-pane fade" id="sF3">
                                                    <div class="col-md-12">
                                                        @if (Model.PreAnalyticalProcedure.Count != 0)
                                                        {
                                                            <div class="col-md-12">
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt><strong>Client Name:</strong></dt>
                                                                        <dd>@ViewBag.ClientNameIntCont</dd>
                                                                        <dt><strong>File No.:</strong></dt>
                                                                        <dd>@ViewBag.FileNo</dd>
                                                                        <dt> <strong>Working Paper Ref:</strong></dt>
                                                                        <dd> @ViewBag.WorkPaperIntCont</dd>
                                                                    </dl>
                                                                </div>
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt>Questionnaire Title</dt>
                                                                        <dd>Preliminary Analytical Procedures</dd>
                                                                        <dt><strong>Prepared By:</strong></dt>
                                                                        <dd>@ViewBag.PreparedByIntCont</dd>
                                                                        <dt><strong>Prepared At:</strong></dt>
                                                                        <dd>@ViewBag.PreparedAtIntCont</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                        }
                                                        @if (Model.PreAnalyticalProcedure.Count == 0)
                                                        {
                                                            <div class="row">
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                                <div class="col-lg-6 col-sm-6 col-xs-6">

                                                                    <div class="alert alert-block alert-info">
                                                                        <a class="close" data-dismiss="alert" href="#">×</a>
                                                                        <center><span>Preliminary Analytical Procedures is not Assigned for this Year</span></center>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                            </div>
                                                        }

                                                        @if (Model.PreAnalyticalProcedure.Count != 0 && ViewBag.IsPreAnalyticalProcAns == false)
                                                        {
                                                            /*BEGIN ADDING QUESTIONNAIRE ANSWERS*/
                                                            using (Html.BeginForm("SaveQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Preliminary Analytical Procedures" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0; }
                                                                        @foreach (var group in Model.PreAnalyticalProcedure.GroupBy(a => a.QuestionnairTitleName))
                                                                        {
                                                                            n++;
                                                                            <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                <td colspan="13">
                                                                                    <strong>
                                                                                        <span class="sign"></span>
                                                                                        @n. @group.Key
                                                                                    </strong>
                                                                                </td>
                                                                            </tr>

                                                                            int y = 0;

                                                                            int num = 0;

                                                                            foreach (var item in group.GroupBy(a => a.Question))
                                                                            {
                                                                                num++;
                                                                                <tr>
                                                                                    <td>@item.Key </td>
                                                                                    @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                    {

                                                                                        foreach (var data in itemx)
                                                                                        {
                                                                                            y++;

                                                                                            if (itemx.Key == "Radio Button")
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                </td>
                                                                                            }

                                                                                            else if (itemx.Key == "Text")
                                                                                            {
                                                                                                <td>
                                                                                                    <label>@data.Value</label>
                                                                                                    <input type="hidden" id="QuestionIdForTextAreas-@y" name="QuestionIdForTextAreas[]" value="@item.Select(a => a.QuestionId).FirstOrDefault()" />
                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]"></textarea>
                                                                                                </td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@y" />
                                                                                                    <label>@data.Value</label>
                                                                                                </td>
                                                                                            }
                                                                                        }
                                                                                    }

                                                                                </tr>
                                                                            }

                                                                        }

                                                                    </tbody>
                                                                </table>

                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>

                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>

                                                                </div>
                                                            }
                                                            /*END ADDING QUESTIONNAIRE ANSWERS*/
                                                        }

                                                        @if (ViewBag.IsPreAnalyticalProcAns)
                                                        {
                                                            using (Html.BeginForm("UpdateQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Preliminary Analytical Procedures" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0;
                                                                        }
                                                                        @if (Model.PreAnalyticalProcedure != null)
                                                                        {
                                                                            foreach (var group in Model.PreAnalyticalProcedure.GroupBy(a => a.QuestionnairTitleName))
                                                                            {
                                                                                n++;
                                                                                <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                    <td colspan="13">
                                                                                        <strong>
                                                                                            <span class="sign"></span>
                                                                                            @n. @group.Key
                                                                                        </strong>
                                                                                    </td>
                                                                                </tr>

                                                                                int y = 0;

                                                                                int num = 0;

                                                                                foreach (var item in group.GroupBy(a => a.Question))
                                                                                {
                                                                                    num++;
                                                                                    <tr>
                                                                                        <td>@item.Key </td>
                                                                                        @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                        {

                                                                                            foreach (var data in itemx)
                                                                                            {
                                                                                                y++;

                                                                                                if (ViewBag.GetPreAnalyticalProcedureAnswers != null)
                                                                                                {
                                                                                                    for (var nm = 0; nm < ViewBag.GetPreAnalyticalProcedureAnswers.Count; nm++)
                                                                                                    {
                                                                                                        if (ViewBag.GetPreAnalyticalProcedureAnswers[nm].QuestionId == @item.Select(a => a.QuestionId).FirstOrDefault())
                                                                                                        {

                                                                                                            if (itemx.Key == "Radio Button")
                                                                                                            {

                                                                                                                if (ViewBag.GetPreAnalyticalProcedureAnswers[nm].Answer == data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetPreAnalyticalProcedureAnswers[nm].Answer-@ViewBag.GetPreAnalyticalProcedureAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                                else if (ViewBag.GetPreAnalyticalProcedureAnswers[nm].Answer != data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetPreAnalyticalProcedureAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                            }
                                                                                                            else if (itemx.Key == "Text")
                                                                                                            {
                                                                                                                <td>
                                                                                                                    <label>@data.Value</label>
                                                                                                                    <input type="hidden" id="QuestionIdForTxtAreas-@y" name="QuestionIdForTxtAreas[]" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetPreAnalyticalProcedureAnswers[nm].QuestionnaireAnswerDetailId" />
                                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]">@ViewBag.GetPreAnalyticalProcedureAnswers[nm].Answer</textarea>
                                                                                                                </td>
                                                                                                            }
                                                                                                            else
                                                                                                            {

                                                                                                                if (ViewBag.GetPreAnalyticalProcedureAnswers[nm].Answer.Contains(","))
                                                                                                                {
                                                                                                                    string[] answerArray = ViewBag.GetPreAnalyticalProcedureAnswers[nm].Answer.Split(',');

                                                                                                                    <td>
                                                                                                                        @for (var z = 0; z < answerArray.Count(); z++)
                                                                                                                        {
                                                                                                                            if (answerArray[z] == data.Value)
                                                                                                                            {
                                                                                                                                <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@answerArray[z]-@ViewBag.GetPreAnalyticalProcedureAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                                <label>@data.Value</label>
                                                                                                                            }
                                                                                                                        }
                                                                                                                        @if (!answerArray.Contains(data.Value))
                                                                                                                        {
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetPreAnalyticalProcedureAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        }

                                                                                                                    </td>
                                                                                                                }
                                                                                                                else
                                                                                                                {
                                                                                                                    if (ViewBag.GetPreAnalyticalProcedureAnswers[nm].Answer == data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" checked value="@item.Select(a => a.QuestionId).FirstOrDefault()_@ViewBag.GetPreAnalyticalProcedureAnswers[nm].Answer-@ViewBag.GetPreAnalyticalProcedureAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                    else if (ViewBag.GetPreAnalyticalProcedureAnswers[nm].Answer != data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetPreAnalyticalProcedureAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                }
                                                                                                            }
                                                                                                        }
                                                                                                    }

                                                                                                }
                                                                                            }
                                                                                        }

                                                                                    </tr>
                                                                                }

                                                                            }
                                                                        }

                                                                    </tbody>
                                                                </table>
                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>
                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>
                                                                </div>
                                                            }
                                                        }

                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <div class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseFour" class="collapse" aria-expanded="false">
                                            <i class="fa fa-lg fa-angle-down pull-right"></i>
                                            <i class="fa fa-lg fa-angle-up pull-right"></i>
                                            <i class="fa fa-fw fa-lg fa-paper-plane-o"></i>
                                            Risk Assessment
                                        </a>
                                    </div>
                                </div>
                                <div id="collapseFour" class="panel-collapse collapse" aria-expanded="false" style="height: 0px;">
                                    <div class="panel-body">
                                        <div class="widget-body">
                                            <hr />
                                            <ul id="myTab4" class="nav nav-tabs bordered">
                                                <li class="active">
                                                    <a href="#sR1" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-slack"></i> Detailed Risk assessment
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li class="">
                                                    <a href="#sR2" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Financial Risk & Assertion Plan
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                @if (Model.FinancialRiskStatus == "Completed")
                                                {
                                                    <li class="">
                                                        <a href="#sR3" data-toggle="tab" aria-expanded="false">
                                                            <i class="fa fa-fw fa-lg  fa-empire"></i> Risk Response Summary
                                                            <span class="badge bg-color-blue txt-color-white"></span>
                                                        </a>
                                                    </li>

                                                    <li class="">
                                                        <a href="#sR4" data-toggle="tab" aria-expanded="false">
                                                            <i class="fa fa-fw fa-lg  fa-sliders"></i>Overall Materiality
                                                            <span class="badge bg-color-blue txt-color-white"></span>
                                                        </a>
                                                    </li>

                                                    <li class="">
                                                        <a href="#sR5" data-toggle="tab" aria-expanded="false">
                                                            <i class="fa fa-fw fa-lg  fa-sliders"></i>Performance Materiality
                                                            <span class="badge bg-color-blue txt-color-white"></span>
                                                        </a>
                                                    </li>
                                                }



                                            </ul>
                                            <div id="myTabContent4" class="tab-content padding-10">
                                                <div class="tab-pane fade active in" id="sR1">
                                                    <form>
                                                        <div class="form-horizontal">
                                                            <div class="col-xs-12">
                                                                <div align="center">
                                                                    <img src="~/Media/Images/ajax_loader.gif" class="loadingImg" />
                                                                </div>
                                                                <div class="form-group">
                                                                    <div class="col-md-12">
                                                                        <div class="col-md-2">
                                                                            <button type="button" class="btn btn-info" onclick="AddIdentifyRisk()">
                                                                                <i class="fa fa-plus"></i> Add New
                                                                                <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-12">

                                                                    <table id="dt_trendAnalysisBasic" class="table table-striped table-bordered table-hover" width="50%">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>#</th>
                                                                                <th>Risk Name</th>
                                                                                <th>Risk Category</th>
                                                                                <th>Risk Ranking</th>
                                                                                <th>Auditable Area Affected</th>
                                                                                <th>Action</th>
                                                                            </tr>
                                                                        </thead>
                                                                        @{
                                                                            int za = 0;
                                                                        }
                                                                        <tbody>
                                                                            @if (Model.RiskAssessedInfo.Count == 0)
                                                                            {
                                                                                <tr>
                                                                                    <td colspan="7" style="text-align:center">
                                                                                        <span style="font-style:italic">
                                                                                            No Risk Identify in this Engagement:
                                                                                            <strong> @Model.EngagementName</strong>
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            }
                                                                            else
                                                                            {
                                                                                foreach (var group in Model.RiskAssessedInfo.GroupBy(a => a.QuestionnairName))
                                                                                {
                                                                                    <tr bgcolor="lightgrey">
                                                                                        <td colspan="5" style="font-weight:bold;width:600px"> @group.Key </td>
                                                                                    </tr>

                                                                                    foreach (var item in group)
                                                                                    {
                                                                                        za++;
                                                                                        <tr>
                                                                                            <td>@za</td>
                                                                                            <td>@item.RiskName</td>
                                                                                            <td>@item.RiskCategory</td>
                                                                                            <td>@item.RiskRanking</td>
                                                                                            <td>
                                                                                                <ul>
                                                                                                    @foreach (var itemx in @item.NewAuditableAreaName)
                                                                                                    {
                                                                                                        <li>
                                                                                                            @itemx
                                                                                                        </li>


                                                                                                    }
                                                                                                </ul>

                                                                                            </td>
                                                                                            <td>
                                                                                                <a href="#" onclick="AddRemoveRisk(@item.RiskAssessedId)"><i class="fa fa fa-fw  fa-trash-o"></i></a>
                                                                                                <a href="#" onclick="EditSelectedRisk(@item.RiskAssessedId)"><i class="fa fa fa-fw   fa-edit"></i></a>
                                                                                            </td>
                                                                                        </tr>
                                                                                    }

                                                                                }
                                                                            }

                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>

                                                </div>
                                                <div class="tab-pane fade" id="sR2">
                                                    <div class="form-horizontal">

                                                        <div class="form-group">
                                                            <div class="col-md-3">
                                                                <button type="submit" class="btn btn-info" id="generateRiskPlanForm">
                                                                    <i class="fa  fa-gears"></i> Generate Plan
                                                                    <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                </button>
                                                            </div>

                                                        </div>

                                                        <table id="dt_financialRiskPlan" class="table table-striped table-bordered table-hover" width="50%">
                                                            <thead>
                                                                <tr>
                                                                    <th>#</th>
                                                                    <th>Risk Name</th>
                                                                    <th>Risk Ranking</th>
                                                                    <th>Assertion Area Affected</th>
                                                                    <th>Assertion Risk Ranking</th>
                                                                    <th>Ref No.</th>
                                                                    <th>Status</th>
                                                                    <th>Action</th>
                                                                </tr>
                                                            </thead>
                                                            @{
                                                                int xy = 0;
                                                            }
                                                            <tbody>
                                                                @if (Enumerable.Count(ViewBag.FinancialStAssRiskPlan) == 0)
                                                                {
                                                                    <tr>
                                                                        <td colspan="9" style="text-align:center">
                                                                            <span style="font-style:italic">
                                                                                No Financial Statement & Assertion Risk Action Plan :
                                                                                <strong> @Model.EngagementName</strong>
                                                                            </span>
                                                                        </td>
                                                                    </tr>
                                                                }
                                                                else
                                                                {
                                                                    foreach (var item in ViewBag.FinancialStAssRiskPlan)
                                                                    {

                                                                        xy++;
                                                                        <tr>
                                                                            <td>@xy</td>
                                                                            <td>@item.RiskName</td>
                                                                            <td>@item.RiskRanking</td>
                                                                            <td>@item.AssertionAreaAffected</td>
                                                                            <td>@item.AssertionRiskRanking</td>
                                                                            <td>@item.RefNo</td>
                                                                            <td>@item.RiskSummaryStatus</td>
                                                                            <td><a href="#" onclick="AssertionRiskPlan(@item.FinancialStAssRiskPlanId)"><i class="fa fa fa-fw  fa-ticket"></i>Add Assertion Detail</a></td>
                                                                        </tr>
                                                                    }
                                                                }

                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="sR3">
                                                    <div class="form-horizontal">
                                                        <div class="form-group">
                                                            <div class="col-md-3">
                                                                <button type="submit" class="btn btn-info" id="generateSummaryForm">
                                                                    <i class="fa  fa-bullseye"></i> Generate Summary
                                                                    <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                </button>
                                                            </div>

                                                        </div>
                                                        <table id="dt_responseSummary" class="table table-striped table-bordered table-hover" width="50%">
                                                            <thead>
                                                                <tr>
                                                                    <th>#</th>
                                                                    <th>Auditable Area</th>
                                                                    <th>Risk Name</th>
                                                                    <th>Financial Risk Ranking</th>
                                                                    <th>Assertion Risk Risk</th>
                                                                    <th>Risk Factor</th>
                                                                    <th>Ref No</th>
                                                                    <th>Action</th>
                                                                </tr>
                                                            </thead>
                                                            @{
                                                                int xo = 0;
                                                            }
                                                            <tbody>
                                                                @if (Enumerable.Count(ViewBag.RiskResponseSummary) == 0)
                                                                {
                                                                    <tr>
                                                                        <td colspan="7" style="text-align:center">
                                                                            <span style="font-style:italic">
                                                                                No Risk Response Summary Created for this Engagement :
                                                                                <strong> @Model.EngagementName</strong>
                                                                            </span>
                                                                        </td>
                                                                    </tr>
                                                                }
                                                                else
                                                                {
                                                                    foreach (var item in ViewBag.RiskResponseSummary)
                                                                    {

                                                                        xo++;
                                                                        <tr>
                                                                            <td>@xo</td>
                                                                            <td>@item.AuditableAreaName</td>
                                                                            <td>@item.FinancialRiskName</td>
                                                                            <td>@item.FinancialRiskRanking</td>
                                                                            <td>@item.AssertionRiskRanking</td>
                                                                            <td>@item.RiskFactor</td>
                                                                            <td>@item.FinancialRefNo</td>
                                                                            <td><a href="#" onclick="RiskResponseSummary(@item.RiskResponseSummaryId)"><i class="fa fa fa-fw  fa-ticket"></i>Add Justification</a></td>
                                                                        </tr>
                                                                    }
                                                                }

                                                            </tbody>
                                                        </table>

                                                    </div>

                                                </div>
                                                <div class="tab-pane fade" id="sR4">
                                                    <div class="form-horizontal">
                                                        <div class="form-group">
                                                            <div class="col-md-3">
                                                                <button type="submit" class="btn btn-info" id="loadDataForMateriality">
                                                                    <i class="fa  fa-gears"></i> Load Data
                                                                    <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                </button>
                                                            </div>


                                                        </div>
                                                        <div>
                                                            @if (Model.MaterialityStatus == null)
                                                            {
                                                                <dl class="form-horizontal" style="font-weight: bold;">
                                                                    No data for Materiality
                                                                </dl>

                                                            }
                                                            else
                                                            {
                                                                <dl class="dl-horizontal">
                                                                    <dt>Client Name:</dt>
                                                                    <dd>@Html.DisplayFor(model => model.ClientName)</dd>
                                                                    <dt>Client Financial Year:</dt>
                                                                    <dd>@Html.DisplayFor(model => model.ClientFinancialYear)</dd>
                                                                    @if (Model.MaterialityMthod == "Tabular Method")
                                                                    {
                                                                        <dt>Total Amount Asset (Tsh):</dt>
                                                                        <dd> @string.Format("{0:#,0.00}", Model.TotalAmountAsset)</dd>
                                                                        <dt>Total Amount Revenue(Tsh):</dt>
                                                                        <dd> @string.Format("{0:#,0.00}", Model.TotalAmountRevenue)</dd>
                                                                        <dt>Lager Amount(Tsh):</dt>
                                                                        <dd>@string.Format("{0:#,0.00}", Model.BiggerDifference)</dd>
                                                                        <dt>Materiality Approach:</dt>
                                                                        <dd>Table Approach</dd>
                                                                    }
                                                                    else if (Model.MaterialityMthod == "Profit Before Tax")
                                                                    {
                                                                        <dt>Total Amount Revenue(Tsh):</dt>
                                                                        <dd> @string.Format("{0:#,0.00}", Model.TotalAmountRevenue)</dd>
                                                                        <dt>Total Amount Expenses(Tsh):</dt>
                                                                        <dd>@string.Format("{0:#,0.00}", Model.TotalAmountExpenses)</dd>
                                                                        <dt>Amount difference(Tsh):</dt>
                                                                        <dd>@string.Format("{0:#,0.00}", Model.BiggerDifference)</dd>
                                                                        <dt>Materiality Approach:</dt>
                                                                        <dd>Benchmark Approach</dd>
                                                                    }
                                                                    else if (Model.MaterialityMthod == "Total Revenue")
                                                                    {
                                                                        <dt>Total Amount Revenue:</dt>
                                                                        <dd>@string.Format("{0:#,0.00}", Model.TotalAmountRevenue)</dd>
                                                                        <dt>Materiality Approach:</dt>
                                                                        <dd>Benchmark Approach</dd>
                                                                    }
                                                                    else if (Model.MaterialityMthod == "Total Expenses")
                                                                    {
                                                                        <dt>Total Amount Expenses(Tsh):</dt>
                                                                        <dd>@string.Format("{0:#,0.00}", Model.TotalAmountExpenses)</dd>
                                                                        <dt>Materiality Approach:</dt>
                                                                        <dd>Benchmark Approach</dd>
                                                                    }
                                                                    else if (Model.MaterialityMthod == "Total Capital")
                                                                    {
                                                                        <dt>Total Amount Capital(Tsh):</dt>
                                                                        <dd>@string.Format("{0:#,0.00}", Model.TotalAmountCapital)</dd>
                                                                        <dt>Materiality Approach:</dt>
                                                                        <dd>Benchmark Approach</dd>
                                                                    }
                                                                    <dt>Materiality Mthod:</dt>
                                                                    <dd>@Html.DisplayFor(model => model.MaterialityMthod)</dd>
                                                                    <dt>Overall Materiality:</dt>
                                                                    <dd>@string.Format("{0:#,0.00}", Model.AnsMateriality)</dd>
                                                                </dl>
                                                            }

                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="sR5">

                                                    <div class="form-horizontal">

                                                        <div class="form-group">
                                                            <div class="col-md-3">
                                                                <button type="submit" class="btn btn-info" id="generatePerformanceMateriality">
                                                                    <i class="fa  fa-gears"></i> Generate
                                                                    <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                </button>
                                                                @*</div>
                                                                    <div class="col-md-3">*@
                                                                @if (Enumerable.Count(ViewBag.PerformanceMateriality) == 0)
                                                                {
                                                                    <button type="submit" class="btn btn-info" id="revokePerformanceMateriality">
                                                                        <i class="fa  fa-mail-reply-all"></i> Revoke
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>
                                                                }

                                                            </div>

                                                        </div>

                                                        <table id="dt_performance" class="table table-striped table-bordered table-hover" width="50%">
                                                            <thead>
                                                                <tr>
                                                                    <th>#</th>
                                                                    <th>Auditable Area</th>
                                                                    <th>Risk Ranking</th>
                                                                    <th>Overall Materiality</th>
                                                                    <th>Performance Materiality</th>
                                                                    <th>Action</th>
                                                                </tr>
                                                            </thead>
                                                            @{
                                                                int jy = 0;
                                                            }
                                                            <tbody>
                                                                @if (Enumerable.Count(ViewBag.PerformanceMateriality) == 0)
                                                                {
                                                                    <tr>
                                                                        <td colspan="9" style="text-align:center">
                                                                            <span style="font-style:italic">
                                                                                No Performance Materiality Generated for this :
                                                                                <strong> @Model.EngagementName</strong>
                                                                            </span>
                                                                        </td>
                                                                    </tr>
                                                                }
                                                                else
                                                                {
                                                                    foreach (var item in ViewBag.PerformanceMateriality)
                                                                    {

                                                                        jy++;
                                                                        <tr>
                                                                            <td>@jy</td>
                                                                            <td>@item.AuditableAreaCode: @item.AuditableAreaName</td>
                                                                            <td>@item.RiskRanking</td>
                                                                            @*<td> @item.OverallMateriality</td>
                                                                                <td> @item.AnsPerfMateriality</td>*@
                                                                            <td style="text-align:right">@string.Format("{0:#,0.00}", @item.OverallMateriality)</td>
                                                                            <td style="text-align:right"> @string.Format("{0:#,0.00}", @item.AnsPerfMateriality)</td>
                                                                            <td><a href="#" onclick="PerformanceMateriality(@item.PerformanceMaterialityId)"><i class="fa fa fa-fw  fa fa-comments-o"></i>Add Justification</a></td>
                                                                        </tr>
                                                                    }
                                                                }

                                                            </tbody>
                                                        </table>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <div class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseFive" class="collapse" aria-expanded="false">
                                            <i class="fa fa-lg fa-angle-down pull-right"></i>
                                            <i class="fa fa-lg fa-angle-up pull-right"></i>
                                            <i class="fa fa-fw fa-lg fa-child"></i>
                                            Member Assignment
                                        </a>
                                    </div>
                                </div>
                                <div id="collapseFive" class="anel-collapse collapse" aria-expanded="false" style="height: 0px;">
                                    <div class="panel-body">
                                        <div class="widget-body">
                                            <hr />
                                            <ul id="myTab5" class="nav nav-tabs bordered">
                                                <li class="active">
                                                    <a href="#m1" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Assignment
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li class="">
                                                    <a href="#m2" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Sample Size
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                            </ul>
                                            <div id="myTabContent5" class="tab-content padding-10">
                                                <div class="tab-pane fade active in" id="m1">
                                                    <div class="form-horizontal">
                                                        <div class="col-xs-12">
                                                            <div align="center">
                                                                <img src="~/Media/Images/ajax_loader.gif" class="loadingImg" />
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="col-md-12">
                                                                <div class="col-md-2">
                                                                    <button type="button" class="btn btn-info" onclick="AddAssignmentAndLeadSchedula()" id="AddAssignmentAndLeadSchedula">
                                                                        <i class="fa fa-plus"></i> Add
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="col-md-12">
                                                                <div class="col-md-12">
                                                                    <table id="dt_ebasic" class="table table-striped table-bordered table-hover" width="50%">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>#</th>
                                                                                @*<th>Member Full Name</th>
                                                                                    <th>Auditable Area</th>*@
                                                                                <th>Auditable Item</th>
                                                                                <th>Action</th>
                                                                            </tr>
                                                                        </thead>
                                                                        @{
                                                                            int s = 0;
                                                                        }
                                                                        <tbody>
                                                                            @if (Model.AssignMemberLeadSch.Count == 0)
                                                                            {
                                                                                <tr>
                                                                                    <td colspan="5" style="text-align:center">
                                                                                        <span style="font-style:italic">
                                                                                            No Member Assigned Member to This Level in this Engagement :
                                                                                            <strong> @Model.EngagementName</strong>
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            }
                                                                            else
                                                                            {
                                                                                foreach (var group in Model.AssignMemberLeadSch.GroupBy(a => a.FullName))
                                                                                {
                                                                                    <tr bgcolor="lightgrey">
                                                                                        <td colspan="5" style="font-weight:bold;width:600px"> @group.Key </td>
                                                                                    </tr>
                                                                                    foreach (var group2 in group.GroupBy(a => a.AuditableAreaName))
                                                                                    {
                                                                                        <tr bgcolor="lightgrey">
                                                                                            <td colspan="5" style="font-weight:bold;width:600px"> @group2.Key </td>
                                                                                        </tr>

                                                                                        foreach (var item in group2)
                                                                                        {
                                                                                            s++;
                                                                                            <tr>
                                                                                                <td>@s</td>
                                                                                                <td>@item.AuditableItemName</td>
                                                                                                <td><a href="#" onclick="AddComments(@item.TrendAnalysisId)"><i class="fa fa fa-fw  fa-trash-o"></i></a></td>
                                                                                            </tr>
                                                                                        }
                                                                                    }
                                                                                }
                                                                            }

                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="m2">
                                                    <div class="form-horizontal">
                                                        <div class="col-xs-12">
                                                            <div align="center">
                                                                <img src="~/Media/Images/ajax_loader.gif" class="loadingImg" />
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="col-md-12">
                                                                <div class="col-md-2">
                                                                    <button type="button" class="btn btn-info" onclick="CalculateSampleSize()" id="CalculateSampleSize">
                                                                        <i class="fa fa-plus"></i> Calculate Sample Size
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="col-md-12">
                                                                <div class="col-md-12">
                                                                    <table id="dt_samplebasic" class="table table-striped table-bordered table-hover" width="50%">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>#</th>
                                                                                <th>Auditable Item</th>
                                                                                <th>Risk Factor</th>
                                                                                <th>Performance Materiality</th>
                                                                                <th>Residual Population</th>
                                                                                <th>Key Item</th>
                                                                                <th>High Value</th>
                                                                                <th>Sample Size Residual</th>
                                                                                <th>Total Sample Size</th>
                                                                                <th>Action</th>
                                                                            </tr>
                                                                        </thead>
                                                                        @{
                                                                            int sxj = 0;
                                                                        }
                                                                        <tbody>
                                                                            @if (Model.SamplingInformation.Count == 0)
                                                                            {
                                                                                <tr>
                                                                                    <td colspan="10" style="text-align:center">
                                                                                        <span style="font-style:italic">
                                                                                            No Data of sampling for :
                                                                                            <strong> @Model.EngagementName</strong>
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            }
                                                                            else
                                                                            {
                                                                                foreach (var group in Model.SamplingInformation.GroupBy(a => a.AuditableAreaName))
                                                                                {
                                                                                    <tr bgcolor="lightgrey">
                                                                                        <td colspan="10" style="font-weight:bold;width:600px"> @group.Key </td>
                                                                                    </tr>

                                                                                    foreach (var item in group)
                                                                                    {
                                                                                        sxj++;
                                                                                        <tr>
                                                                                            <td>@sxj</td>
                                                                                            <td>@item.AuditableItem</td>
                                                                                            <td>@item.RiskFactor</td>
                                                                                            <td>@string.Format("{0:#,0.00}", @item.PerformanceMateriality)</td>
                                                                                            <td>@string.Format("{0:#,0.00}", @item.ResidualPopulation)</td>
                                                                                            <td>@item.KeyItem</td>
                                                                                            <td>@item.HighValue</td>
                                                                                            <td>@item.SampleSize</td>
                                                                                            <td>@string.Format("{0:#,0.00}", @item.TotalSampleSize)</td>
                                                                                            <td>
                                                                                                <a href="#" onclick="DeleteSample(@item.SampleSizeId)"><i class="fa fa fa-fw  fa-trash-o"></i></a>
                                                                                                @*<a href="#" onclick="EditSample(@item.SampleSizeId)"><i class="fa fa fa-fw  fa-edit"></i></a>*@
                                                                                            </td>
                                                                                        </tr>
                                                                                    }
                                                                                }
                                                                            }

                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <div class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseSix" class="collapse" aria-expanded="false">
                                            <i class="fa fa-lg fa-angle-down pull-right"></i>
                                            <i class="fa fa-lg fa-angle-up pull-right"></i>
                                            <i class="fa fa-fw fa-lg fa-tasks"></i>
                                            Planning Issues
                                        </a>
                                    </div>
                                </div>
                                <div id="collapseSix" class="anel-collapse collapse" aria-expanded="false" style="height: 0px;">
                                    <div class="panel-body">
                                        <div class="widget-body">
                                            <hr />
                                            <ul id="myTab6" class="nav nav-tabs border">
                                                <li class="active">
                                                    <a href="#mp1" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Other Planning Issues
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li class="">
                                                    <a href="#mp2" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Budget & Performance Summary
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li class="">
                                                    <a href="#mp3" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Fraud Risk Factors
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li class="">
                                                    <a href="#mp4" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Meeting CheckList
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li class="">
                                                    <a href="#mp5" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Notes of Planning Meeting
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                            </ul>
                                            <div id="myTabContent6" class="tab-content padding-10">
                                                <div class="tab-pane fade active in" id="mp1">
                                                    <div class="col-md-12">
                                                        @if (Model.PlanningIssueQn.Count != 0)
                                                        {
                                                            <div class="col-md-12">
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt><strong>Client Name:</strong></dt>
                                                                        <dd>@ViewBag.ClientName</dd>
                                                                        <dt><strong>File No.:</strong></dt>
                                                                        <dd>@ViewBag.FileNo</dd>
                                                                        <dt> <strong>Working Paper Ref:</strong></dt>
                                                                        <dd> @ViewBag.WorkPaper</dd>
                                                                    </dl>
                                                                </div>
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt>Questionnaire Title</dt>
                                                                        <dd>Other Planning Issues</dd>
                                                                        <dt><strong>Prepared By:</strong></dt>
                                                                        <dd>@ViewBag.PreparedBy</dd>
                                                                        <dt><strong>Prepared At:</strong></dt>
                                                                        <dd>@ViewBag.PreparedAt</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                        }

                                                        @if (Model.PlanningIssueQn.Count == 0)
                                                        {
                                                            <div class="row">
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                                <div class="col-lg-6 col-sm-6 col-xs-6">

                                                                    <div class="alert alert-block alert-info">
                                                                        <a class="close" data-dismiss="alert" href="#">×</a>
                                                                        <center><span>Other Planning Issues is not Assigned for this Year</span></center>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                            </div>
                                                        }

                                                        @if (Model.PlanningIssueQn.Count != 0 && ViewBag.IsPlanningQnAns == false)
                                                        {

                                                            /*BEGIN ADDING QUESTIONNAIRE ANSWERS*/
                                                            using (Html.BeginForm("SaveQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Other Planning Issues" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0; }
                                                                        @foreach (var group in Model.PlanningIssueQn.GroupBy(a => a.QuestionnairTitleName))
                                                                        {
                                                                            n++;
                                                                            <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                <td colspan="13">
                                                                                    <strong>
                                                                                        <span class="sign"></span>
                                                                                        @n. @group.Key
                                                                                    </strong>
                                                                                </td>
                                                                            </tr>

                                                                            int y = 0;

                                                                            int num = 0;

                                                                            foreach (var item in group.GroupBy(a => a.Question))
                                                                            {
                                                                                num++;
                                                                                <tr>
                                                                                    <td>@item.Key </td>
                                                                                    @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                    {

                                                                                        foreach (var data in itemx)
                                                                                        {
                                                                                            y++;

                                                                                            if (itemx.Key == "Radio Button")
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                </td>
                                                                                            }

                                                                                            else if (itemx.Key == "Text")
                                                                                            {
                                                                                                <td>
                                                                                                    <label>@data.Value</label>
                                                                                                    <input type="hidden" id="QuestionIdForTextAreas-@y" name="QuestionIdForTextAreas[]" value="@item.Select(a => a.QuestionId).FirstOrDefault()" />
                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]"></textarea>
                                                                                                </td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@y" />
                                                                                                    <label>@data.Value</label>
                                                                                                </td>
                                                                                            }
                                                                                        }
                                                                                    }

                                                                                </tr>
                                                                            }

                                                                        }

                                                                    </tbody>
                                                                </table>

                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>

                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>

                                                                </div>
                                                            }
                                                            /*END ADDING QUESTIONNAIRE ANSWERS*/
                                                        }

                                                        @if (ViewBag.IsPlanningQnAns)
                                                        {
                                                            using (Html.BeginForm("UpdateQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Other Planning Issues" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0;
                                                                        }
                                                                        @if (Model.PlanningIssueQn != null)
                                                                        {
                                                                            foreach (var group in Model.PlanningIssueQn.GroupBy(a => a.QuestionnairTitleName))
                                                                            {
                                                                                n++;
                                                                                <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                    <td colspan="13">
                                                                                        <strong>
                                                                                            <span class="sign"></span>
                                                                                            @n. @group.Key
                                                                                        </strong>
                                                                                    </td>
                                                                                </tr>

                                                                                int y = 0;

                                                                                int num = 0;

                                                                                foreach (var item in group.GroupBy(a => a.Question))
                                                                                {
                                                                                    num++;
                                                                                    <tr>
                                                                                        <td>@item.Key </td>
                                                                                        @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                        {

                                                                                            foreach (var data in itemx)
                                                                                            {
                                                                                                y++;

                                                                                                if (ViewBag.GetPlanningQuestAnswers != null)
                                                                                                {
                                                                                                    for (var nm = 0; nm < ViewBag.GetPlanningQuestAnswers.Count; nm++)
                                                                                                    {
                                                                                                        if (ViewBag.GetPlanningQuestAnswers[nm].QuestionId == @item.Select(a => a.QuestionId).FirstOrDefault())
                                                                                                        {

                                                                                                            if (itemx.Key == "Radio Button")
                                                                                                            {

                                                                                                                if (ViewBag.GetPlanningQuestAnswers[nm].Answer == data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetPlanningQuestAnswers[nm].Answer-@ViewBag.GetPlanningQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                                else if (ViewBag.GetPlanningQuestAnswers[nm].Answer != data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetPlanningQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                            }
                                                                                                            else if (itemx.Key == "Text")
                                                                                                            {
                                                                                                                <td>
                                                                                                                    <label>@data.Value</label>
                                                                                                                    <input type="hidden" id="QuestionIdForTxtAreas-@y" name="QuestionIdForTxtAreas[]" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetPlanningQuestAnswers[nm].QuestionnaireAnswerDetailId" />
                                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]">@ViewBag.GetPlanningQuestAnswers[nm].Answer</textarea>
                                                                                                                </td>
                                                                                                            }
                                                                                                            else
                                                                                                            {

                                                                                                                if (ViewBag.GetPlanningQuestAnswers[nm].Answer.Contains(","))
                                                                                                                {
                                                                                                                    string[] answerArray = ViewBag.GetPlanningQuestAnswers[nm].Answer.Split(',');

                                                                                                                    <td>
                                                                                                                        @for (var z = 0; z < answerArray.Count(); z++)
                                                                                                                        {
                                                                                                                            if (answerArray[z] == data.Value)
                                                                                                                            {
                                                                                                                                <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@answerArray[z]-@ViewBag.GetPlanningQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                                <label>@data.Value</label>
                                                                                                                            }
                                                                                                                        }
                                                                                                                        @if (!answerArray.Contains(data.Value))
                                                                                                                        {
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetPlanningQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        }

                                                                                                                    </td>
                                                                                                                }
                                                                                                                else
                                                                                                                {
                                                                                                                    if (ViewBag.GetPlanningQuestAnswers[nm].Answer == data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" checked value="@item.Select(a => a.QuestionId).FirstOrDefault()_@ViewBag.GetPlanningQuestAnswers[nm].Answer-@ViewBag.GetPlanningQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                    else if (ViewBag.GetPlanningQuestAnswers[nm].Answer != data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetPlanningQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                }
                                                                                                            }
                                                                                                        }
                                                                                                    }

                                                                                                }
                                                                                            }
                                                                                        }

                                                                                    </tr>
                                                                                }

                                                                            }
                                                                        }

                                                                    </tbody>
                                                                </table>
                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>
                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>
                                                                </div>
                                                            }
                                                        }

                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="mp2">
                                                    Budget & Performance Summary
                                                </div>
                                                <div class="tab-pane fade" id="mp3">
                                                    <div class="col-md-12">
                                                        @if (Model.FraudRiskFactorQn.Count != 0)
                                                        {
                                                            <div class="col-md-12">
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt><strong>Client Name:</strong></dt>
                                                                        <dd>@ViewBag.ClientName</dd>
                                                                        <dt><strong>File No.:</strong></dt>
                                                                        <dd>@ViewBag.FileNo</dd>
                                                                        <dt> <strong>Working Paper Ref:</strong></dt>
                                                                        <dd> @ViewBag.WorkPaper</dd>
                                                                    </dl>
                                                                </div>
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt>Questionnaire Title</dt>
                                                                        <dd>Fraud Risk Factors</dd>
                                                                        <dt><strong>Prepared By:</strong></dt>
                                                                        <dd>@ViewBag.PreparedBy</dd>
                                                                        <dt><strong>Prepared At:</strong></dt>
                                                                        <dd>@ViewBag.PreparedAt</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                        }

                                                        @if (Model.FraudRiskFactorQn.Count == 0)
                                                        {
                                                            <div class="row">
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                                <div class="col-lg-6 col-sm-6 col-xs-6">

                                                                    <div class="alert alert-block alert-info">
                                                                        <a class="close" data-dismiss="alert" href="#">×</a>
                                                                        <center><span>Fraud Risk Factors is not Assigned for this Year</span></center>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                            </div>
                                                        }
                                                        @if (Model.FraudRiskFactorQn.Count != 0 && ViewBag.IsFraudFactorQnAns == false)
                                                        {
                                                            /*BEGIN ADDING QUESTIONNAIRE ANSWERS*/
                                                            using (Html.BeginForm("SaveQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Fraud Risk Factors" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0; }
                                                                        @foreach (var group in Model.FraudRiskFactorQn.GroupBy(a => a.QuestionnairTitleName))
                                                                        {
                                                                            n++;
                                                                            <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                <td colspan="13">
                                                                                    <strong>
                                                                                        <span class="sign"></span>
                                                                                        @n. @group.Key
                                                                                    </strong>
                                                                                </td>
                                                                            </tr>

                                                                            int y = 0;

                                                                            int num = 0;

                                                                            foreach (var item in group.GroupBy(a => a.Question))
                                                                            {
                                                                                num++;
                                                                                <tr>
                                                                                    <td>@item.Key </td>
                                                                                    @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                    {

                                                                                        foreach (var data in itemx)
                                                                                        {
                                                                                            y++;

                                                                                            if (itemx.Key == "Radio Button")
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                </td>
                                                                                            }

                                                                                            else if (itemx.Key == "Text")
                                                                                            {
                                                                                                <td>
                                                                                                    <label>@data.Value</label>
                                                                                                    <input type="hidden" id="QuestionIdForTextAreas-@y" name="QuestionIdForTextAreas[]" value="@item.Select(a => a.QuestionId).FirstOrDefault()" />
                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]"></textarea>
                                                                                                </td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@y" />
                                                                                                    <label>@data.Value</label>
                                                                                                </td>
                                                                                            }
                                                                                        }
                                                                                    }

                                                                                </tr>
                                                                            }

                                                                        }

                                                                    </tbody>
                                                                </table>

                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>

                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>

                                                                </div>
                                                            }
                                                            /*END ADDING QUESTIONNAIRE ANSWERS*/
                                                        }

                                                        @if (ViewBag.IsFraudFactorQnAns)
                                                        {
                                                            using (Html.BeginForm("UpdateQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Fraud Risk Factors" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0;
                                                                        }
                                                                        @if (Model.FraudRiskFactorQn != null)
                                                                        {
                                                                            foreach (var group in Model.FraudRiskFactorQn.GroupBy(a => a.QuestionnairTitleName))
                                                                            {
                                                                                n++;
                                                                                <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                    <td colspan="13">
                                                                                        <strong>
                                                                                            <span class="sign"></span>
                                                                                            @n. @group.Key
                                                                                        </strong>
                                                                                    </td>
                                                                                </tr>

                                                                                int y = 0;

                                                                                int num = 0;

                                                                                foreach (var item in group.GroupBy(a => a.Question))
                                                                                {
                                                                                    num++;
                                                                                    <tr>
                                                                                        <td>@item.Key </td>
                                                                                        @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                        {

                                                                                            foreach (var data in itemx)
                                                                                            {
                                                                                                y++;

                                                                                                if (ViewBag.GetFraudFactorQuestAnswers != null)
                                                                                                {
                                                                                                    for (var nm = 0; nm < ViewBag.GetFraudFactorQuestAnswers.Count; nm++)
                                                                                                    {
                                                                                                        if (ViewBag.GetFraudFactorQuestAnswers[nm].QuestionId == @item.Select(a => a.QuestionId).FirstOrDefault())
                                                                                                        {

                                                                                                            if (itemx.Key == "Radio Button")
                                                                                                            {

                                                                                                                if (ViewBag.GetFraudFactorQuestAnswers[nm].Answer == data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetFraudFactorQuestAnswers[nm].Answer-@ViewBag.GetFraudFactorQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                                else if (ViewBag.GetFraudFactorQuestAnswers[nm].Answer != data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetFraudFactorQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                    </td>
                                                                                                                }
                                                                                                            }
                                                                                                            else if (itemx.Key == "Text")
                                                                                                            {
                                                                                                                <td>
                                                                                                                    <label>@data.Value</label>
                                                                                                                    <input type="hidden" id="QuestionIdForTxtAreas-@y" name="QuestionIdForTxtAreas[]" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetFraudFactorQuestAnswers[nm].QuestionnaireAnswerDetailId" />
                                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]">@ViewBag.GetFraudFactorQuestAnswers[nm].Answer</textarea>
                                                                                                                </td>
                                                                                                            }
                                                                                                            else
                                                                                                            {

                                                                                                                if (ViewBag.GetFraudFactorQuestAnswers[nm].Answer.Contains(","))
                                                                                                                {
                                                                                                                    string[] answerArray = ViewBag.GetFraudFactorQuestAnswers[nm].Answer.Split(',');

                                                                                                                    <td>
                                                                                                                        @for (var z = 0; z < answerArray.Count(); z++)
                                                                                                                        {
                                                                                                                            if (answerArray[z] == data.Value)
                                                                                                                            {
                                                                                                                                <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@answerArray[z]-@ViewBag.GetFraudFactorQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                                <label>@data.Value</label>
                                                                                                                            }
                                                                                                                        }
                                                                                                                        @if (!answerArray.Contains(data.Value))
                                                                                                                        {
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetFraudFactorQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        }

                                                                                                                    </td>
                                                                                                                }
                                                                                                                else
                                                                                                                {
                                                                                                                    if (ViewBag.GetFraudFactorQuestAnswers[nm].Answer == data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" checked value="@item.Select(a => a.QuestionId).FirstOrDefault()_@ViewBag.GetFraudFactorQuestAnswers[nm].Answer-@ViewBag.GetFraudFactorQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                    else if (ViewBag.GetFraudFactorQuestAnswers[nm].Answer != data.Value)
                                                                                                                    {
                                                                                                                        <td>
                                                                                                                            <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetFraudFactorQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        </td>
                                                                                                                    }
                                                                                                                }
                                                                                                            }
                                                                                                        }
                                                                                                    }

                                                                                                }
                                                                                            }
                                                                                        }

                                                                                    </tr>
                                                                                }

                                                                            }
                                                                        }

                                                                    </tbody>
                                                                </table>
                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>
                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>
                                                                </div>
                                                            }
                                                        }

                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="mp4">
                                                    Planing Meeting CheckList
                                                </div>
                                                <div class="tab-pane fade" id="mp5">
                                                    Notes of Planning Meeting
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <div class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseSeven" class="collapse" aria-expanded="false">
                                            <i class="fa fa-lg fa-angle-down pull-right"></i>
                                            <i class="fa fa-lg fa-angle-up pull-right"></i>
                                            <i class="fa fa-fw fa-lg fa-tags"></i>
                                            Quality Control
                                        </a>
                                    </div>
                                </div>
                                <div id="collapseSeven" class="anel-collapse collapse" aria-expanded="false" style="height: 0px;">
                                    <div class="panel-body">
                                        <div class="widget-body">
                                            <hr />
                                            <ul id="myTab7" class="nav nav-tabs border">
                                                <li class="active">
                                                    <a href="#mq1" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-pied-piper"></i>Audit Administration
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li class="">
                                                    <a href="#mq2" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Quality Control
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>
                                                <li class="">
                                                    <a href="#mq3" data-toggle="tab" aria-expanded="false">
                                                        <i class="fa fa-fw fa-lg  fa-pied-piper"></i> Memorandum
                                                        <span class="badge bg-color-blue txt-color-white"></span>
                                                    </a>
                                                </li>

                                            </ul>
                                            <div id="myTabContent6" class="tab-content padding-10">
                                                <div class="tab-pane fade active in" id="mq1">
                                                    <div class="col-md-12">
                                                        @if (Model.AuditAdministrationQn.Count != 0)
                                                        {
                                                            <div class="col-md-12">
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt><strong>Client Name:</strong></dt>
                                                                        <dd>@ViewBag.ClientName</dd>
                                                                        <dt><strong>File No.:</strong></dt>
                                                                        <dd>@ViewBag.FileNo</dd>
                                                                        <dt> <strong>Working Paper Ref:</strong></dt>
                                                                        <dd> @ViewBag.WorkPaper</dd>
                                                                    </dl>
                                                                </div>
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt>Questionnaire Title</dt>
                                                                        <dd> Audit Administration</dd>
                                                                        <dt><strong>Prepared By:</strong></dt>
                                                                        <dd>@ViewBag.PreparedBy</dd>
                                                                        <dt><strong>Prepared At:</strong></dt>
                                                                        <dd>@ViewBag.PreparedAt</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                        }

                                                        @if (Model.AuditAdministrationQn.Count == 0)
                                                        {
                                                            <div class="row">
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                                <div class="col-lg-6 col-sm-6 col-xs-6">

                                                                    <div class="alert alert-block alert-info">
                                                                        <a class="close" data-dismiss="alert" href="#">×</a>
                                                                        <center><span>Audit Administration is not Assigned for this Year</span></center>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                            </div>
                                                        }
                                                        @if (Model.AuditAdministrationQn.Count != 0 && ViewBag.IsAuditAdministrationQnAns == false)
                                                        {
                                                            /*BEGIN ADDING QUESTIONNAIRE ANSWERS*/
                                                            using (Html.BeginForm("SaveQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Audit Administration" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0; }
                                                                        @foreach (var group in Model.AuditAdministrationQn.GroupBy(a => a.QuestionnairTitleName))
                                                                        {
                                                                            n++;
                                                                            <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                <td colspan="13">
                                                                                    <strong>
                                                                                        <span class="sign"></span>
                                                                                        @n. @group.Key
                                                                                    </strong>
                                                                                </td>
                                                                            </tr>

                                                                            int y = 0;

                                                                            int num = 0;

                                                                            foreach (var item in group.GroupBy(a => a.Question))
                                                                            {
                                                                                num++;
                                                                                <tr>
                                                                                    <td>@item.Key </td>
                                                                                    @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                    {

                                                                                        foreach (var data in itemx)
                                                                                        {
                                                                                            y++;

                                                                                            if (itemx.Key == "Radio Button")
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                </td>
                                                                                            }

                                                                                            else if (itemx.Key == "Text")
                                                                                            {
                                                                                                <td>
                                                                                                    <label>@data.Value</label>
                                                                                                    <input type="hidden" id="QuestionIdForTextAreas-@y" name="QuestionIdForTextAreas[]" value="@item.Select(a => a.QuestionId).FirstOrDefault()" />
                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]"></textarea>
                                                                                                </td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@y" />
                                                                                                    <label>@data.Value</label>
                                                                                                </td>
                                                                                            }
                                                                                        }
                                                                                    }

                                                                                </tr>
                                                                            }

                                                                        }

                                                                    </tbody>
                                                                </table>

                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>

                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>

                                                                </div>
                                                            }
                                                            /*END ADDING QUESTIONNAIRE ANSWERS*/
                                                        }

                                                        @if (ViewBag.IsAuditAdministrationQnAns)
                                                        {
                                                            using (Html.BeginForm("UpdateQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Audit Administration" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0;
                                                                        }
                                                                        @if (Model.AuditAdministrationQn != null)
                                                                        {
                                                                            foreach (var group in Model.AuditAdministrationQn.GroupBy(a => a.QuestionnairTitleName))
                                                                            {
                                                                                n++;
                                                                                <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                    <td colspan="13">
                                                                                        <strong>
                                                                                            <span class="sign"></span>
                                                                                            @n. @group.Key
                                                                                        </strong>
                                                                                    </td>
                                                                                </tr>

                                                                                int y = 0;

                                                                                int num = 0;

                                                                                foreach (var item in group.GroupBy(a => a.Question))
                                                                                {
                                                                                    num++;
                                                                                    <tr>
                                                                                        <td>@item.Key </td>
                                                                                        @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                        {

                                                                                            foreach (var data in itemx)
                                                                                            {
                                                                                                y++;

                                                                                                for (var nm = 0; nm < ViewBag.GetAuditAdministrationQuestAnswers.Count; nm++)
                                                                                                {
                                                                                                    if (ViewBag.GetAuditAdministrationQuestAnswers[nm].QuestionId == @item.Select(a => a.QuestionId).FirstOrDefault())
                                                                                                    {

                                                                                                        if (itemx.Key == "Radio Button")
                                                                                                        {

                                                                                                            if (ViewBag.GetAuditAdministrationQuestAnswers[nm].Answer == data.Value)
                                                                                                            {
                                                                                                                <td>
                                                                                                                    <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetAuditAdministrationQuestAnswers[nm].Answer-@ViewBag.GetAuditAdministrationQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                </td>
                                                                                                            }
                                                                                                            else if (ViewBag.GetAuditAdministrationQuestAnswers[nm].Answer != data.Value)
                                                                                                            {
                                                                                                                <td>
                                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetAuditAdministrationQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                </td>
                                                                                                            }
                                                                                                        }
                                                                                                        else if (itemx.Key == "Text")
                                                                                                        {
                                                                                                            <td>
                                                                                                                <label>@data.Value</label>
                                                                                                                <input type="hidden" id="QuestionIdForTxtAreas-@y" name="QuestionIdForTxtAreas[]" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetAuditAdministrationQuestAnswers[nm].QuestionnaireAnswerDetailId" />
                                                                                                                <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]">@ViewBag.GetAuditAdministrationQuestAnswers[nm].Answer</textarea>
                                                                                                            </td>
                                                                                                        }
                                                                                                        else
                                                                                                        {

                                                                                                            if (ViewBag.GetAuditAdministrationQuestAnswers[nm].Answer.Contains(","))
                                                                                                            {
                                                                                                                string[] answerArray = ViewBag.GetAuditAdministrationQuestAnswers[nm].Answer.Split(',');

                                                                                                                <td>
                                                                                                                    @for (var z = 0; z < answerArray.Count(); z++)
                                                                                                                    {
                                                                                                                        if (answerArray[z] == data.Value)
                                                                                                                        {
                                                                                                                            <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@answerArray[z]-@ViewBag.GetAuditAdministrationQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        }
                                                                                                                    }
                                                                                                                    @if (!answerArray.Contains(data.Value))
                                                                                                                    {
                                                                                                                        <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetAuditAdministrationQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                        <label>@data.Value</label>
                                                                                                                    }

                                                                                                                </td>
                                                                                                            }
                                                                                                            else
                                                                                                            {
                                                                                                                if (ViewBag.GetAuditAdministrationQuestAnswers[nm].Answer == data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" checked value="@item.Select(a => a.QuestionId).FirstOrDefault()_@ViewBag.GetAuditAdministrationQuestAnswers[nm].Answer-@ViewBag.GetAuditAdministrationQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                        <label>@data.Value</label>
                                                                                                                    </td>
                                                                                                                }
                                                                                                                else if (ViewBag.GetAuditAdministrationQuestAnswers[nm].Answer != data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetAuditAdministrationQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                        <label>@data.Value</label>
                                                                                                                    </td>
                                                                                                                }
                                                                                                            }
                                                                                                        }
                                                                                                    }
                                                                                                }

                                                                                            }
                                                                                        }

                                                                                    </tr>
                                                                                }

                                                                            }
                                                                        }

                                                                    </tbody>
                                                                </table>
                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>
                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>
                                                                </div>
                                                            }
                                                        }

                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="mq2">
                                                    <div class="col-md-12">
                                                        @if (Model.QualityControlQn.Count != 0)
                                                        {
                                                            <div class="col-md-12">
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt><strong>Client Name:</strong></dt>
                                                                        <dd>@ViewBag.ClientName</dd>
                                                                        <dt><strong>File No.:</strong></dt>
                                                                        <dd>@ViewBag.FileNo</dd>
                                                                        <dt> <strong>Working Paper Ref:</strong></dt>
                                                                        <dd> @ViewBag.WorkPaper</dd>
                                                                    </dl>
                                                                </div>
                                                                <div class="col-md-6" style="padding-top:20px">
                                                                    <dl class="dl-horizontal">
                                                                        <dt>Questionnaire Title</dt>
                                                                        <dd>Quality Control</dd>
                                                                        <dt><strong>Prepared By:</strong></dt>
                                                                        <dd>@ViewBag.PreparedBy</dd>
                                                                        <dt><strong>Prepared At:</strong></dt>
                                                                        <dd>@ViewBag.PreparedAt</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                        }

                                                        @if (Model.QualityControlQn.Count == 0)
                                                        {
                                                            <div class="row">
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                                <div class="col-lg-6 col-sm-6 col-xs-6">

                                                                    <div class="alert alert-block alert-info">
                                                                        <a class="close" data-dismiss="alert" href="#">×</a>
                                                                        <center><span>Quality Control is not Assigned for this Year</span></center>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-3 col-sm-3 col-xs-3"></div>
                                                            </div>
                                                        }
                                                        @if (Model.QualityControlQn.Count != 0 && ViewBag.IsQualityControlQnAns == false)
                                                        {
                                                            /*BEGIN ADDING QUESTIONNAIRE ANSWERS*/
                                                            using (Html.BeginForm("SaveQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Quality Control" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0; }
                                                                        @foreach (var group in Model.QualityControlQn.GroupBy(a => a.QuestionnairTitleName))
                                                                        {
                                                                            n++;
                                                                            <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                <td colspan="13">
                                                                                    <strong>
                                                                                        <span class="sign"></span>
                                                                                        @n. @group.Key
                                                                                    </strong>
                                                                                </td>
                                                                            </tr>

                                                                            int y = 0;

                                                                            int num = 0;

                                                                            foreach (var item in group.GroupBy(a => a.Question))
                                                                            {
                                                                                num++;
                                                                                <tr>
                                                                                    <td>@item.Key </td>
                                                                                    @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                    {

                                                                                        foreach (var data in itemx)
                                                                                        {
                                                                                            y++;

                                                                                            if (itemx.Key == "Radio Button")
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                </td>
                                                                                            }

                                                                                            else if (itemx.Key == "Text")
                                                                                            {
                                                                                                <td>
                                                                                                    <label>@data.Value</label>
                                                                                                    <input type="hidden" id="QuestionIdForTextAreas-@y" name="QuestionIdForTextAreas[]" value="@item.Select(a => a.QuestionId).FirstOrDefault()" />
                                                                                                    <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]"></textarea>
                                                                                                </td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td>
                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value" name="Answers[]" id="Answers-@y" />
                                                                                                    <label>@data.Value</label>
                                                                                                </td>
                                                                                            }
                                                                                        }
                                                                                    }

                                                                                </tr>
                                                                            }

                                                                        }

                                                                    </tbody>
                                                                </table>

                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>

                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>

                                                                </div>
                                                            }
                                                            /*END ADDING QUESTIONNAIRE ANSWERS*/
                                                        }

                                                        @if (ViewBag.IsQualityControlQnAns)
                                                        {
                                                            using (Html.BeginForm("UpdateQuestionnaire", "PlanningEngagement", FormMethod.Post, new { enctype = "multipart/form-data", onsubmit = "return validateForm(this);" }))
                                                            {
                                                                @Html.AntiForgeryToken()
                                                                <input type="hidden" name="ModuleId" id="ModuleId" value="@ViewBag.PlanningEngagementId" />
                                                                <input type="hidden" name="Category" id="Category" value="Quality Control" />
                                                                <table id="example" class="table table-striped table-bordered table-hover" width="100%">
                                                                    <thead><tr></tr></thead>
                                                                    <tbody>
                                                                        @{ int n = 0;
                                                                        }
                                                                        @if (Model.QualityControlQn != null)
                                                                        {
                                                                            foreach (var group in Model.QualityControlQn.GroupBy(a => a.QuestionnairTitleName))
                                                                            {
                                                                                n++;
                                                                                <tr data-level='1' style="background:#f5f5f5; color:#000000">
                                                                                    <td colspan="13">
                                                                                        <strong>
                                                                                            <span class="sign"></span>
                                                                                            @n. @group.Key
                                                                                        </strong>
                                                                                    </td>
                                                                                </tr>

                                                                                int y = 0;

                                                                                int num = 0;

                                                                                foreach (var item in group.GroupBy(a => a.Question))
                                                                                {
                                                                                    num++;
                                                                                    <tr>
                                                                                        <td>@item.Key </td>
                                                                                        @foreach (var itemx in item.GroupBy(a => a.Lebal))
                                                                                        {

                                                                                            foreach (var data in itemx)
                                                                                            {
                                                                                                y++;

                                                                                                for (var nm = 0; nm < ViewBag.GetQualityCntQuestAnswers.Count; nm++)
                                                                                                {
                                                                                                    if (ViewBag.GetQualityCntQuestAnswers[nm].QuestionId == @item.Select(a => a.QuestionId).FirstOrDefault())
                                                                                                    {

                                                                                                        if (itemx.Key == "Radio Button")
                                                                                                        {

                                                                                                            if (ViewBag.GetQualityCntQuestAnswers[nm].Answer == data.Value)
                                                                                                            {
                                                                                                                <td>
                                                                                                                    <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetQualityCntQuestAnswers[nm].Answer-@ViewBag.GetQualityCntQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                </td>
                                                                                                            }
                                                                                                            else if (ViewBag.GetQualityCntQuestAnswers[nm].Answer != data.Value)
                                                                                                            {
                                                                                                                <td>
                                                                                                                    <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetQualityCntQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@num" onclick="AllowSingleSelection(this);" />@data.Value
                                                                                                                </td>
                                                                                                            }
                                                                                                        }
                                                                                                        else if (itemx.Key == "Text")
                                                                                                        {
                                                                                                            <td>
                                                                                                                <label>@data.Value</label>
                                                                                                                <input type="hidden" id="QuestionIdForTxtAreas-@y" name="QuestionIdForTxtAreas[]" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@ViewBag.GetQualityCntQuestAnswers[nm].QuestionnaireAnswerDetailId" />
                                                                                                                <textarea class="form-control answers" id="Answers-@y" rows="4" cols="150" name="Answers[]">@ViewBag.GetQualityCntQuestAnswers[nm].Answer</textarea>
                                                                                                            </td>
                                                                                                        }
                                                                                                        else
                                                                                                        {

                                                                                                            if (ViewBag.GetQualityCntQuestAnswers[nm].Answer.Contains(","))
                                                                                                            {
                                                                                                                string[] answerArray = ViewBag.GetQualityCntQuestAnswers[nm].Answer.Split(',');

                                                                                                                <td>
                                                                                                                    @for (var z = 0; z < answerArray.Count(); z++)
                                                                                                                    {
                                                                                                                        if (answerArray[z] == data.Value)
                                                                                                                        {
                                                                                                                            <input type="checkbox" class="answers" checked value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@answerArray[z]-@ViewBag.GetQualityCntQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                            <label>@data.Value</label>
                                                                                                                        }
                                                                                                                    }
                                                                                                                    @if (!answerArray.Contains(data.Value))
                                                                                                                    {
                                                                                                                        <input type="checkbox" class="answers" value="@item.Select(a=>a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetQualityCntQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                        <label>@data.Value</label>
                                                                                                                    }

                                                                                                                </td>
                                                                                                            }
                                                                                                            else
                                                                                                            {
                                                                                                                if (ViewBag.GetQualityCntQuestAnswers[nm].Answer == data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" checked value="@item.Select(a => a.QuestionId).FirstOrDefault()_@ViewBag.GetQualityCntQuestAnswers[nm].Answer-@ViewBag.GetQualityCntQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                        <label>@data.Value</label>
                                                                                                                    </td>
                                                                                                                }
                                                                                                                else if (ViewBag.GetQualityCntQuestAnswers[nm].Answer != data.Value)
                                                                                                                {
                                                                                                                    <td>
                                                                                                                        <input type="checkbox" class="answers" value="@item.Select(a => a.QuestionId).FirstOrDefault()_@data.Value-@ViewBag.GetQualityCntQuestAnswers[nm].QuestionnaireAnswerDetailId" name="Answers[]" id="Answers-@y" />
                                                                                                                        <label>@data.Value</label>
                                                                                                                    </td>
                                                                                                                }
                                                                                                            }
                                                                                                        }
                                                                                                    }
                                                                                                }

                                                                                            }
                                                                                        }

                                                                                    </tr>
                                                                                }

                                                                            }
                                                                        }

                                                                    </tbody>
                                                                </table>
                                                                <div class="form-group">
                                                                    <div class="col-md-1"></div>
                                                                    <button type="submit" name="submit" class="btn btn-info" id="saveAnswerForm">
                                                                        <i class="fa fa-save"></i> Save
                                                                        <img src="~/Content/img/loading.gif" class="loadingImg" />
                                                                    </button>
                                                                </div>
                                                            }
                                                        }

                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="mq3">
                                                    MEMORANDUM
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>

        </div>
    </section>
</div>

<div class="modal fade" id="AddEstimateModal" style="left:4%">
    <div class="modal-dialog" style="width:80%;">
        <div class="modal-content panel-info">
            <div class="modal-header panel-heading">
                <a href="#" class="close" data-dismiss="modal">&times;</a>
                <h3 class="modal-title"> Review Account Estimate </h3>
            </div>
            <div class="modal-body" style="overflow-x: auto;">
                <div class="form-horizontal">
                    <div class="col-sm-12">
                        <div class="form-group">
                            <label class="control-label col-md-2">Account Estimate<span class="redStar">*</span></label>
                            <div class="col-md-3">
                                <select id="AccountEstimateId" name="AccountEstimateId" class="form-control select2" required="required">
                                    <option value="">Select Account Estimate</option>
                                    @foreach (var item in Model.AccountEstimateList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </div>
                            <label class="control-label col-md-2">Risk Assessment<span class="redStar">*</span></label>
                            <div class="col-md-3">
                                @Html.DropDownList("OverallRiskAssessment", new List<SelectListItem>{
                                                        new SelectListItem{ Text="--Select Answer Type ---", Value = "" },
                                                        new SelectListItem{ Text="High", Value = "High" },
                                                        new SelectListItem{ Text="Medium", Value = "Medium" },
                                                        new SelectListItem{ Text="Low", Value = "Low" },
                                                        }, new { @class = "form-control select2", @required = "required" })
                                @Html.ValidationMessageFor(model => model.OverallRiskAssessment, "", new { @class = "text-danger" })

                            </div>
                        </div>

                        <div class="form-group">
                            <label class="control-label col-md-2">Previous Year Amount<span class="redStar">*</span></label>
                            <div class="col-md-3">
                                @Html.TextBoxFor(model => model.PreYearAmount, new { @Class = "input", @required = "required", @type = "number", @min = "0", style = "width:100%; display:block;border:1px solid #ccc;padding:8px;" })
                            </div>

                            <label class="control-label col-md-2">Current Year Amount<span class="redStar">*</span></label>
                            <div class="col-md-3">
                                @Html.TextBoxFor(model => model.CurYearAmount, new { @Class = "input", @required = "required", @type = "number", @min = "0", style = "width:100%; display:block;border:1px solid #ccc;padding:8px;" })
                            </div>
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(model => model.AuditApproach, htmlAttributes: new { @class = "control-label col-md-2 required" })
                            (<span style="font-weight:bold;" id="AuditApproachCount">250</span>)
                            <div class="col-md-8">
                                @Html.TextAreaFor(model => model.AuditApproach, new { maxlength = 250, @class = "form-control", @rows = 2, @cols = 2 })
                                @Html.ValidationMessageFor(model => model.AuditApproach, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        <div class="form-group">
                            @Html.LabelFor(model => model.DegreeOfestimationncertainty, htmlAttributes: new { @class = "control-label col-md-2 required" })
                            (<span style="font-weight:bold;" id="UncertintyCount">250</span>)
                            <div class="col-md-8">
                                @Html.TextAreaFor(model => model.DegreeOfestimationncertainty, new { maxlength = 250, @class = "form-control", @rows = 2, @cols = 2 })
                                @Html.ValidationMessageFor(model => model.DegreeOfestimationncertainty, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-2">Method<span class="redStar">*</span></label>
                            <div class="col-md-3">
                                @Html.TextBoxFor(model => model.Method, new { @Class = "input", @required = "required", style = "width:100%; display:block;border:1px solid #ccc;padding:8px;" })
                            </div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-info" id="btnSaveAccountEst" style="margin-bottom:10px">
                        <i class="fa fa-save"></i>Save
                    </button>
                    <button class="btn btn-info" data-dismiss="modal" style="margin-bottom:10px">
                        <i class="fa  fa-times"></i>Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modalEditAccountEst" class="modal fade" style="left:4%">
    <div class="modal-dialog" style="width:80%;">
        <div class="modal-content panel-info">
            <div class="modal-header alert alert-info">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h3 class="modal-title">Edit Account Estimate</h3>
            </div>
            <div class="modal-body" id="modalEditAccountEstBody"></div>
            <div class="modal-footer">

                <button class="btn btn-info" id="updateByEditAccountEstimate">
                    <i class="fa fa-save"> Update</i>
                </button>
                <button class="btn btn-info" data-dismiss="modal">
                    <i class="fa fa-times"> Close</i>
                </button>
            </div>
        </div>
    </div>
</div>

<div id="ReviewOfInternalControl" class="modal fade" style="left:4%">
    <div class="modal-dialog" style="width:80%;">
        <div class="modal-content panel-info">
            <div class="modal-header alert alert-info">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h3 class="modal-title">Review of Internal Control</h3>
            </div>
            <div class="modal-body" id="modalReviewInternalControlBody"></div>
            <div class="modal-footer">

                <button class="btn btn-info" id="reviewInternalControl">
                    <i class="fa fa-save"> Review</i>
                </button>
                <button class="btn btn-info" data-dismiss="modal">
                    <i class="fa fa-times"> Close</i>
                </button>
            </div>
        </div>
    </div>
</div>

<div id="noteToAccount" class="modal fade" style="left:4%">
    <div class="modal-dialog" style="width:70%;">
        <div class="modal-content panel-info">
            <div class="modal-header alert alert-info">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h3 class="modal-title">Add Note To Accounts</h3>
            </div>
            <div class="modal-body" id="noteToAccountBody"></div>
            <div class="modal-footer">

                <button class="btn btn-info" id="addNewNoteToAccounts">
                    <i class="fa fa-save"> Add</i>
                </button>
                <button class="btn btn-info" data-dismiss="modal">
                    <i class="fa fa-times"> Close</i>
                </button>
            </div>
        </div>
    </div>
</div>

<div id="riskAssertion" class="modal fade" style="left:4%">
    <div class="modal-dialog" style="width:70%;">
        <div class="modal-content panel-info">
            <div class="modal-header alert alert-info">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h3 class="modal-title">Risk Assertion</h3>
            </div>
            <div class="modal-body" id="riskAssertionBody"></div>
            <div class="modal-footer">

                <button class="btn btn-info" id="addRiskAssertionData">
                    <i class="fa fa-save"> Save</i>
                </button>
                <button class="btn btn-info" data-dismiss="modal">
                    <i class="fa fa-times"> Close</i>
                </button>
            </div>
        </div>
    </div>
</div>

<div id="performance" class="modal fade" style="left:4%">
    <div class="modal-dialog" style="width:70%;">
        <div class="modal-content panel-info">
            <div class="modal-header alert alert-info">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h3 class="modal-title">Justification </h3>
            </div>
            <div class="modal-body" id="performanceBody"></div>
            <div class="modal-footer">

                <button class="btn btn-info" id="addperformanceData">
                    <i class="fa fa-save"> Save</i>
                </button>
                <button class="btn btn-info" data-dismiss="modal">
                    <i class="fa fa-times"> Close</i>
                </button>
            </div>
        </div>
    </div>
</div>

<div id="sampleSizeId" class="modal fade" style="left:4%">
    <div class="modal-dialog" style="width:70%;">
        <div class="modal-content panel-info">
            <div class="modal-header alert alert-info">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h3 class="modal-title">Sample Size </h3>
            </div>
            <div class="modal-body" id="sampleBody"></div>
            <div class="modal-footer">

                <button class="btn btn-info" id="SampleSizeModal">
                    <i class="fa fa-save"></i>Save
                </button>
                <button class="btn btn-info" data-dismiss="modal">
                    <i class="fa fa-times"></i>Close
                </button>
            </div>
        </div>
    </div>
</div>

<div id="summaryComment" class="modal fade" style="left:4%">
    <div class="modal-dialog" style="width:70%;">
        <div class="modal-content panel-info">
            <div class="modal-header alert alert-info">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h3 class="modal-title">Add Justification For Risk</h3>
            </div>
            <div class="modal-body" id="summaryCommentBody"></div>
            <div class="modal-footer">

                <button class="btn btn-info" id="addSummaryCommentData">
                    <i class="fa fa-save"> Save</i>
                </button>
                <button class="btn btn-info" data-dismiss="modal">
                    <i class="fa fa-times"> Close</i>
                </button>
            </div>
        </div>
    </div>
</div>

<div id="trendAnalysis" class="modal fade" style="left:4%">
    <div class="modal-dialog" style="width:70%;">
        <div class="modal-content panel-info">
            <div class="modal-header alert alert-info">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h3 class="modal-title">Add Comments</h3>
            </div>
            <div class="modal-body" id="trendAnalysisBody"></div>
            <div class="modal-footer">

                <button class="btn btn-info" id="addCommentsToTrend">
                    <i class="fa fa-save"> Add</i>
                </button>
                <button class="btn btn-info" data-dismiss="modal">
                    <i class="fa fa-times"> Close</i>
                </button>
            </div>
        </div>
    </div>
</div>

<!--New Implementation-->
<!----------- Search GL Items ----------------->
<div class="modal fade" id="glItemsModal" style="left:4%">

    <div class="modal-dialog" style="width:80%;">
        <div class="modal-content panel-info">
            <div class="modal-header panel-heading">
                <a href="#" class="close" data-dismiss="modal">&times;</a>
                <h3 class="modal-title"> Add Note To Accounts</h3>
            </div>
            <div class="modal-body">
                <table id="dt_noteToAccount" class="table table-striped table-bordered table-hover table-condensed" width="100%">
                    <thead>
                        <tr>
                            <th> #</th>
                            <th>Auditable Item</th>
                            <th>Previous Year Amount</th>
                        </tr>
                    </thead>
                </table>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-info" id="btn_save_gl_items">
                        <i class="fa fa-save"></i>Save
                    </button>
                    <button class="btn btn-info" data-dismiss="modal">
                        <i class="fa  fa-times"></i>Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!--bStart of Assignment of Member and Create Lead Schedule-->
<div class="modal fade" id="AddMemberLeadSchedulModal" style="left:4%">
    <div class="modal-dialog" style="width:80%;">
        <div class="modal-content panel-info">
            <div class="modal-header panel-heading">
                <a href="#" class="close" data-dismiss="modal">&times;</a>
                <h3 class="modal-title">Assign Member with Lead Schedule </h3>
            </div>
            <div class="modal-body" style="overflow-x: auto;">
                <div class="form-horizontal">
                    <div class="col-sm-12">
                        @Html.HiddenFor(model => model.EngagementId)
                        <div class="form-group">
                            <label class="control-label col-md-2">Member<span class="redStar">*</span></label>
                            <div class="col-md-8">
                                <select id="UserId" name="UserId" class="form-control select2" required="required">
                                    <option value="">Select Full Name</option>
                                    @foreach (var item in Model.MemberAssignList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-2">Auditable Area<span class="redStar">*</span></label>
                            <div class="col-md-8">
                                <select id="AuditableAreaId" name="AuditableAreaId" class="form-control select2" required="required">
                                    <option value="">Select Auditable Area</option>
                                    @foreach (var item in Model.AuditableAreaAssignList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </div>
                        </div>

                        <div class="form-group" id="auditableitemList" style="display: none">
                            <div class="col-md-1"></div>
                            <div class="col-md-10">
                                <table class='table table-striped table-bordered table-hover'>
                                    <thead>
                                        <tr>
                                            <td><strong>#</strong></td>
                                            <td><strong>Auditable Item</strong> </td>
                                            <td><strong>Previous Amount</strong> </td>
                                            <td><strong>Current Amount</strong> </td>
                                            <td><strong>Assign</strong> <input type="checkbox" name="checkAll" class="qnCheckAll" /></td>
                                        </tr>
                                    </thead>
                                    <tbody id="itemToAssignlist">
                                    </tbody>
                                </table>
                            </div>
                            <div class="col-md-1"></div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-info" id="btnSaveAssignment" style="margin-bottom:10px">
                        <i class="fa fa-save"></i> Add
                    </button>
                    <button class="btn btn-info" data-dismiss="modal" style="margin-bottom:10px">
                        <i class="fa  fa-times"></i>Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!--End of Assignment of Member-->
@section pagespecific {
    <!-- PAGE RELATED PLUGIN(S) -->
    <script type="text/javascript">

         var inValidScores = [];
        function validateForm(formObj) {
            debugger;
            $(".loadingImg").show();
            formObj.submit.disabled = true;
            formObj.submit.value = 'Please Wait...';
            successMessage = true;
            console.log(formObj);

            $("#saveAnswerForm").prop('disabled', true);
        }

        var response = '@TempData["Response"]';
        switch (response) {
            case "UnderstandingClientSuccess":
                 $("#saveAnswerForm").prop('disabled', false);
                 swal("Understand Client saved successfully", { icon: "success" })
                .then((value) => {
                    var url = '@Url.Action("CreatePlanningEngagement", "PlanningEngagement")';
                    var new_url = url + "?id=" + '@ViewBag.PlanningEngagementId';
                    window.location.replace(new_url);
                });
                break;
            case "UnderstandingClientError":
                 $("#saveAnswerForm").prop('disabled', false);
                 swal("An error occur during saving Understand Client Questionnaire, Please Contact System Support", { icon: "warning" })
                .then((value) => {
                    var url = '@Url.Action("CreatePlanningEngagement", "PlanningEngagement")';
                    var new_url = url + "?id=" + '@ViewBag.PlanningEngagementId';
                    window.location.replace(new_url);
                });
                break;

            case "InternalControlSuccess":
                 $("#saveAnswerForm").prop('disabled', false);
                 swal("Internal Control Questionnaire saved successfully", { icon: "success" })
                .then((value) => {
                    var url = '@Url.Action("CreatePlanningEngagement", "PlanningEngagement")';
                    var new_url = url + "?id=" + '@ViewBag.PlanningEngagementId';
                    window.location.replace(new_url);
                });
                break;
            case "InternalControlError":
                 $("#saveAnswerForm").prop('disabled', false);
                 swal("An error occur during saving Internal Control Questionnaire, Please Contact System Support", { icon: "warning" })
                .then((value) => {
                    var url = '@Url.Action("CreatePlanningEngagement", "PlanningEngagement")';
                    var new_url = url + "?id=" + '@ViewBag.PlanningEngagementId';
                    window.location.replace(new_url);
                });
                break;


            case "GeneralIntControlSuccess":
                 $("#saveAnswerForm").prop('disabled', false);
                 swal("General Internal Questionnaire saved successfully", { icon: "success" })
                .then((value) => {
                    var url = '@Url.Action("CreatePlanningEngagement", "PlanningEngagement")';
                    var new_url = url + "?id=" + '@ViewBag.PlanningEngagementId';
                    window.location.replace(new_url);
                });
                break;
            case "GeneralIntControlError":
                 $("#saveAnswerForm").prop('disabled', false);
                swal("An error occur during saving General Internal Questionnaire, Please Contact System Support", { icon: "warning" })
                .then((value) => {
                    var url = '@Url.Action("CreatePlanningEngagement", "PlanningEngagement")';
                    var new_url = url + "?id=" + '@ViewBag.PlanningEngagementId';
                    window.location.replace(new_url);
                });
                break;

            case "PreAnalyticalProcSuccess":
                 $("#saveAnswerForm").prop('disabled', false);
                 swal("Preliminary Analytical Procedures saved successfully", { icon: "success" })
                .then((value) => {
                    var url = '@Url.Action("CreatePlanningEngagement", "PlanningEngagement")';
                    var new_url = url + "?id=" + '@ViewBag.PlanningEngagementId';
                    window.location.replace(new_url);
                });
                break;
            case "PreAnalyticalProcError":
                 $("#saveAnswerForm").prop('disabled', false);
                swal("An error occur during saving Preliminary Analytical Procedures, Please Contact System Support", { icon: "warning" })
                .then((value) => {
                    var url = '@Url.Action("CreatePlanningEngagement", "PlanningEngagement")';
                    var new_url = url + "?id=" + '@ViewBag.PlanningEngagementId';
                    window.location.replace(new_url);
                });
                break;


            @*case "Error":
                 $("#saveAnswerForm").prop('disabled', false);
                swal("An error occur, Please Contact System Support", { iscon: "warning" })
                .then((value) => {
                    var url = '@Url.Action("CreatePreliminaryAnalysis", "PreliminaryAnalysis")';
                    var new_url = url + "?id=" + '@ViewBag.PreliminaryAnalysisId';
                    window.location.replace(new_url);
                });
                break;*@

        }

        function AllowSingleSelection(checkboxObject) {
            var getQuestion = checkboxObject.value;
            var question = getQuestion.substring(0, getQuestion.indexOf('_'));
            //Get the parent control of checkbox which is the checkbox list
            var checkboxObjectList = checkboxObject.parentNode.parentNode.parentNode;
            //Get the checkbox controls in checkboxlist
            var checkboxControls = checkboxObjectList.getElementsByTagName("input");
            //Loop through each check box controls
            for (var i = 0; i < checkboxControls.length; i++) {
                //Check the current checkbox is not the one user selected
                if (checkboxControls[i] != checkboxObject && checkboxObject.checked &&
                    question == checkboxControls[i].value.substring(0, checkboxControls[i].value.indexOf('_'))) {
                    //Uncheck all other checkboxes
                    checkboxControls[i].checked = false;
                }
            }
        }
        //////Clear script after Questionnaire Implemen

        //$("#PreYearAmount").autoNumeric('init');
        //$("#CurYearAmount").autoNumeric('init');

        // Order by the grouping
        $('#example tbody').on('click', 'tr.group', function () {
            var currentOrder = table.order()[0];
            if (currentOrder[0] === groupColumn && currentOrder[1] === 'asc') {
                table.order([groupColumn, 'desc']).draw();
            } else {
                table.order([groupColumn, 'asc']).draw();
            }
        });

        //Count input char
        $('#AuditApproach').on("keyup", function () {
            var count = $('#AuditApproach').val().split('');
            var numChars = 250 - parseInt(count.length);
            $('#AuditApproachCount').text(parseInt(numChars));
        });

        //Count input char
        $('#Method').on("keyup", function () {
            var count = $('#Method').val().split('');
            var numChars = 250 - parseInt(count.length);
            $('#UncertintyCount').text(parseInt(numChars));
        });


        //$(document).ready(function () {
        //    $('#example').DataTable();
        //});

        //$("#saveAnswerForm").click(function (){
        //    debugger;
        //    var data = example.DataTable().rows().data();
        //});



        //function ReviewInternalControl() {
        //    $("#ReviewOfInternalControl").modal("show");
        //}

        function AddAccountEstimate() {
            $("#AddEstimateModal").modal("show");
        }

        $("#btnSaveAccountEst").click(function () {
            debugger;
            var accountEstimateId = $("#AccountEstimateId").val();
            var overallRiskAssessment = $("#OverallRiskAssessment").val();
            var preYearAmount = $("#PreYearAmount").val();
            var curYearAmount = $("#CurYearAmount").val();
            var auditApproach = $("#AuditApproach").val();
            var estimateUncertainty = $("#DegreeOfestimationncertainty").val();
            var method = $("#Method").val();


            if (accountEstimateId == '' || overallRiskAssessment == ''
                || preYearAmount == '' || curYearAmount == '' || auditApproach == ''
                || estimateUncertainty == '' || method=='' ) {
                swal("Please Fill All the required Fields", { icon: "warning" });
                return false;
            }
            var formdata = new FormData();
            formdata.append("__RequestVerificationToken", $('[name=__RequestVerificationToken]').val());
            formdata.append("AccountEstimateId", $("#AccountEstimateId").val());
            formdata.append("OverallRiskAssessment", $("#OverallRiskAssessment").val());
            formdata.append("PreYearAmount", $("#PreYearAmount").val());
            formdata.append("CurYearAmount", $("#CurYearAmount").val());
            formdata.append("AuditApproach", $("#AuditApproach").val());
            formdata.append("EngagementId", $("#EngagementId").val());
            formdata.append("DegreeOfestimationncertainty", $("#DegreeOfestimationncertainty").val());
            formdata.append("Method", $("#Method").val());

            $("#btnSaveAccountEst").prop('disabled', true);
            $("#divLoader").toggle(true);
            var url = '@Url.Action("SaveAccountEstimates", "Engagement")';
            $.ajax({
                url: url,
                data: formdata,
                type: 'POST',
                contentType: false,
                processData: false,
                success: function (response) {
                    console.log('response', response)
                    $("#btnSaveAccountEst").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    if (response == "Success") {
                        swal("Saved Successfully!", { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    } else if (response == "Dublicate") {
                        swal("Dublicate Estimate!", { icon: "warning" })
                            .then((value) => {
                                return false;
                            });
                    }
                    else {
                        swal(response);
                    }
                },
                failure: function (error) {
                    $("#btnSaveAccountEst").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    swal(error);
                }
            });
        });


        $("#divLoader").toggle(false);
        $("#addEngTeamMember").click(function () {
            debugger;
            var auditorId = $("#AuditorId").val();
            var engagementId = $("#EngagementId").val();
            var engagementRoleId = $("#EngagementRoleId").val();

            if (auditorId == '' || engagementId == '' || engagementRoleId=='') {
                swal("Please Fill All the required Fields", {icon: "warning"});
                return false;
            }

            var formdata = new FormData();
            formdata.append("__RequestVerificationToken", $('[name=__RequestVerificationToken]').val());
            formdata.append("AuditorId", $("#AuditorId").val());
            formdata.append("AuditorName", $("#select2-chosen-1").text());
            formdata.append("EngagementId", $("#EngagementId").val());
            formdata.append("EngagementRoleId", $("#EngagementRoleId").val());
            formdata.append("MemberLevel", $("#select2-chosen-2").text());



            for (const value of formdata.values()) {
                console.log(value);
            }

            var url = '@Url.Action("SaveEngagementTeamMember", "Engagement")';
            @*var urlReturn = '@Url.Action("engagementassignment", "Engagement")/?id=' + engagementId;*@
            $("#saveEngagementForm").prop('disabled', true);
            $("#divLoader").toggle(true);

            $.ajax({
                url: url,
                data: formdata,
                type: 'POST',
                contentType: false,
                processData: false,
                success: function (response) {
                    console.log('response', response)
                    $("#saveEngagementForm").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    if (response == "Success") {
                        swal("Saved Successfully!", { icon: "success" })
                            .then((value) => {
                                /*window.location.href = urlReturn;*/
                                window.location.reload();
                            });
                    } else if(response =="Dublicate") {
                        swal("Dublicate Team Member Registered!", { icon: "warning" })
                            .then((value) => {
                                window.location.reload();
                            });
                    } else if (response =="Existing") {
                        swal("Team Member already Registered!", { icon: "warning" })
                            .then((value) => {
                                window.location.reload();
                            });
                    } else if (response =="Role Existing") {
                        swal("Only one Member with Team Leader Role!", { icon: "warning" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                    else {
                        swal(response);
                    }
                },
                failure: function (error) {
                    $("#saveEngagementForm").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    swal(error);
                }
            });
        })


        function RemoveMember(id) {
            swal({
                title: "Are you sure?",
                text: "Once Remove, You will not be able to recover",
                buttons: ["Yes", "No"],
                closeOnClickOutside: false,
            }).then(function (isConfirm) {
                if (isConfirm) {
                    swal("Cancelled", "No change was made");
                } else {
                    RemoveSelectedMember(id);
                }
            });
        }

        function RemoveSelectedMember(id, index) {
            var params = { "id": id };
            var url = '@Url.Action("RemoveSelectedMember", "Engagement")';
            $.ajax({
                type: "get",
                url: url,
                data: params,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    if (response = "success") {
                        swal("Selected Member Removed Successfully", { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                },
                failure: function (response) {
                    alert(response.d);
                }
            });
        }

        function RemoveAccountEst(id) {
            swal({
                title: "Are you sure?",
                text: "Once Remove, You will not be able to recover",
                buttons: ["Yes", "No"],
                closeOnClickOutside: false,
            }).then(function (isConfirm) {
                if (isConfirm) {
                    swal("Cancelled", "No change was made");
                } else {
                    RemoveSelectedAccountEst(id);
                }
            });
        }

        function RemoveSelectedAccountEst(id, index) {
            var params = { "id": id };
            var url = '@Url.Action("RemoveSelectedAccountEstimate", "Engagement")';
            $.ajax({
                type: "get",
                url: url,
                data: params,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    if (response = "success") {
                        swal("Selected Estimate Removed Successfully", { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                },
                failure: function (response) {
                    alert(response.d);
                }
            });
        }

        var EditAccountEst = function (id) {
            debugger
            var url = '@Url.Action("GetToEditAccountEst", "Engagement")/' + id;
           $("#updateByAdd").hide();
           $("#updateByEdit").show();
            $("#modalEditAccountEstBody").load(url, function () {
                $("#modalEditAccountEst").modal({
                    backdrop: "static",
                    keyboard: false
                })
            });
        }

        var ReviewInternalControl = function (id) {
            debugger
            var engId = $("#EngagementId").val();
            var url = '@Url.Action("GetInternalControlData", "Engagement")';
            url += '?id=' + id + '&engId=' + engId;
           $("#reviewInternalControl").show();
            $("#modalReviewInternalControlBody").load(url, function () {
                $("#ReviewOfInternalControl").modal({
                    backdrop: "static",
                    keyboard: false
                })
            });
        }

        var AddNoteToAccount = function (id,fy) {
            debugger
           var url = '@Url.Action("GetAuditableItemData", "Engagement")';
            url += '?id=' + id + '&fy='+fy;
           $("#addNewNoteToAccounts").show();
            $("#noteToAccountBody").load(url, function () {
                $("#noteToAccount").modal({
                    backdrop: "static",
                    keyboard: false
                })
            });
        }




        var AddComments = function (id) {
            debugger

           var url = '@Url.Action("GetTrendAnalysisMovement", "PlanningEngagement")';
           url += '?id=' + id;
           $("#addCommentsToTrend").show();
            $("#trendAnalysisBody").load(url, function () {
                $("#trendAnalysis").modal({
                    backdrop: "static",
                    keyboard: false
                })
            });
        }




        //function AddNoteToAccount(id) {
        //    debugger;
        //    updateNotToAccountTable(id);
        //    $('#glItemsModal').modal('show');
        //}

        //var dt_noteToAccount = $('#dt_noteToAccount').dataTable({
        //    "language": {
        //        "emptyTable": '<strong id="loader" style="color:green">No matching records found</strong>',
        //        "zeroRecords": "No matching records found"
        //    },
        //});


        function updateNotToAccountTable(id) {
            $("#loader").text("Loading Please Wait...")
            debugger;
            //var subvote = $("#departmentCode").val();
            //var distributionfinancialYear = $("#distributionfinancialYear").val();

            var url = '@Url.Action("GetAuditableItem", "Engagement")';
            var params = { "id": id };

            $.ajax({
                type: "get",
                url: url,
                data: params,
                contenttype: "application/json; charset=utf-8",
                datatype: "json",
                success: function (response) {
                    data = response.data;
                    dt_noteToAccount.fnClearTable();
                    for (var i = 1; i < data.length; i++) {
                        //var emb = data[i]["FundingRefNo"];
                        dt_noteToAccount.fnAddData([i,
                            data[i]["AuditableItemName"],
                            '<amount-input type="text" placeholder="Amount" id="Id1-' + i + '" onkeyup="amountChanged(' + i + ')"/>',
                            '<amount-input type="text" placeholder="Amount" id="Id2-' + i + '" onkeyup="amountChanged(' + i + ')"/>'
                        ]);
                    }

                },
                failure: function (error) {
                    swal(error);
                }

            });
        }


        function AddAssignmentAndLeadSchedula() {
            $("#AddMemberLeadSchedulModal").modal("show");
        }

         $("#AuditableAreaId").change(function () {
            var id = $(this).val();
            if (id != "") {

                var option = [];
                $.ajax({
                    url: '@Url.Action("GetListAuditableItem", "PlanningEngagement")/?id=' + id,
                    type: "GET",
                    dataType: "json",
                    success: function (data) {
                        option.empty;
                        var n = 0;
                        data.data.forEach(q => {
                            n++;
                            option.push('<tr><td>' + n + '</td><td>' + q["AuditableItemName"] + '</td><td>' + q["PreviousYearAmount"] + '</td><td>' + q["CurrentYearAmount"] + '</td><td><input type="checkbox"  class="checkBoxAssign"  value="' + q["TrendAnalysisId"] + '"></td></tr>');

                        });
                        $("#auditableitemList").show();
                        $("#itemToAssignlist").html(option);
                    }
                });
            }
        });


        $("#btnSaveAssignment").click(function () {
            debugger;
            var trendAnalysisId = [];

            $("input:checkbox.checkBoxAssign").each(function () {
                if ($(this).prop("checked")) {
                    trendAnalysisId.push($(this).val());
                    console.log('Ids', $(this).val());
                }
            });

            if (trendAnalysisId.length == 0) {
                swal("Please check atleast One Auditable Item!", { icon: "warning" });
                return;
            }

            var userId = $("#UserId").val();
            var engagementId = $("#EngagementId").val();
            var auditableAreaId = $("#AuditableAreaId").val();
            //var auditableAreaName = $("#AuditableAreaId option:selected").text();

            if (userId == '' || auditableAreaId == '') {
                swal("Please Fill All the required Fields", { icon: "warning" });
                return false;
            }

            var formdata = new FormData();
            formdata.append("__RequestVerificationToken", $('[name=__RequestVerificationToken]').val());
            formdata.append("AuditableAreaId", auditableAreaId);
            formdata.append("EngagementId", engagementId);
            formdata.append("UserId", userId);
            //formdata.append("AuditableAreaName", auditableAreaName);
            formdata.append("TrendAnalysisMovementIds", trendAnalysisId);



            for (const value of formdata.values()) {
                console.log(value);
            }

            var url = '@Url.Action("SaveAuditableItemAssign", "PlanningEngagement")';
            @*//var urlList = '@Url.ActionQuestionnairAssignListnt",Questionnairsnt")';*@
            $("#btnSaveAssignment").prop('disabled', true);
            $("#divLoader").toggle(true);

            $.ajax({
                url: url,
                data: formdata,
                type: 'POST',
                contentType: false,
                processData: false,
                success: function (response) {
                    $("#btnSaveAssignment").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    if (response == "Success") {
                        swal("Saved Successfully!", { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                    else {
                        swal(response);
                    }
                },
                failure: function (error) {
                    $("#btnSaveAssignment").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    swal(error);
                }
            });
        });

        function AddIdentifyRisk() {
            debugger;
            var clientId = $("#ClientInformationId").val();
            var plId = '@ViewBag.PlanningEngagementId';
            var fy = '@ViewBag.ClientFinancialYear';
             var url = '@Url.Action("RiskIdentificationProcess", "PlanningEngagement")';
            var new_url = url + "?clientId=" + clientId + "&planningEngagementId=" + plId +"&fy="+ fy;
            window.location.replace(new_url);
        }

        function AddRemoveRisk(id) {
            swal({
                title: "Are you sure?",
                text: "Once Remove, You will not be able to recover",
                buttons: ["Yes", "No"],
                closeOnClickOutside: false,
            }).then(function (isConfirm) {
                if (isConfirm) {
                    swal("Cancelled", "No change was made");
                } else {
                    RemoveSelectedRisk(id);
                }
            });
        }

        function RemoveSelectedRisk(id, index) {
            var params = { "id": id };
            var url = '@Url.Action("RemoveSelectedRisk", "PlanningEngagement")';
            $.ajax({
                type: "get",
                url: url,
                data: params,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    if (response = "success") {
                        swal("Selected Risk Removed Successfully", { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                },
                failure: function (response) {
                    alert(response.d);
                }
            });
        }


        $("#ClientInformationIdx").change(function () {
            debugger;
            var clientId = $("#ClientInformationIdx").val();
            document.getElementById('FinancialYearName').value = "";

            if (!(clientId == null)) {
                if (!(clientId == "")) {
                    $("#divLoader").show();
                    var url = '@Url.Action("GetClientFinancialYear", "PlanningEngagement")';
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: { id: clientId },
                        success: function (data, status, jqXHR) {
                            $("#divLoader").hide();
                            if (data.success) {
                                var dateValue = ToJavaScriptDate(data.FinancialYear);
                                document.getElementById('FinancialYearName').value = dateValue;

                            } else {
                                swal("Please Add Client Year End", { icon: "warning" });
                                //document.getElementById('ClientYearEnd').style.color ="red";
                                document.getElementById('FinancialYearName').value = "";
                                $("#saveEngagementForm").prop('disabled', true);
                            }
                        }
                    });
                }
            }

        });

        $("#generateRiskPlanForm").click(function () {
            debugger;

            var planningEngagementId = '@ViewBag.PlanningEngagementId';
            //var clientDataId = $("#ClientInformationIdx").val();
            //var clientFy = $("#FinancialYearName").val();

            var formdata = new FormData();
            formdata.append("__RequestVerificationToken", $('[name=__RequestVerificationToken]').val());
            formdata.append("PlanningEngagementId", planningEngagementId);
            //formdata.append("FinancialYearName", clientFy);


            for (const value of formdata.values()) {
                console.log(value);
            }

            var url = '@Url.Action("SaveGeneratedFinancialRiskPlan", "PlanningEngagement")';
            $("#btnSaveAssignment").prop('disabled', true);
            $("#divLoader").toggle(true);

            $.ajax({
                url: url,
                data: formdata,
                type: 'POST',
                contentType: false,
                processData: false,
                success: function (resultData) {
                    $().prop('disabled', false);
                    $("#divLoader").toggle(false);
                    if (resultData.response == "Generated") {
                        swal(resultData.responseBody, { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    } else if (resultData.response == "Pending") {
                        swal(resultData.responseBody, { icon: "info" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                    else {
                        swal(resultData.response, {icon: "warning"});
                    }
                },
                failure: function (error) {
                    $("#generateRiskPlanForm").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    swal(error, {icon:"warning"});
                }
            });
        });

        var AssertionRiskPlan = function (id) {
            debugger

           var url = '@Url.Action("GetFinancialRiskPlanData", "PlanningEngagement")';
           url += '?id=' + id;
           $("#addRiskAssertionData").show();
            $("#riskAssertionBody").load(url, function () {
                $("#riskAssertion").modal({
                    backdrop: "static",
                    keyboard: false
                })
            });
        }

        $("#generateSummaryForm").click(function () {
            debugger;

            var planningEngagementId = '@ViewBag.PlanningEngagementId';
            //var clientDataId = $("#ClientInformationIdx").val();
            //var clientFy = $("#FinancialYearName").val();

            var formdata = new FormData();
            formdata.append("__RequestVerificationToken", $('[name=__RequestVerificationToken]').val());
            formdata.append("PlanningEngagementId", planningEngagementId);
            //formdata.append("FinancialYearName", clientFy);


            for (const value of formdata.values()) {
                console.log(value);
            }

            var url = '@Url.Action("SaveGeneratedRiskResponseSummary", "PlanningEngagement")';
            $("#generateSummaryForm").prop('disabled', true);
            $("#divLoader").toggle(true);

            $.ajax({
                url: url,
                data: formdata,
                type: 'POST',
                contentType: false,
                processData: false,
                success: function (resultData) {
                    $().prop('disabled', false);
                    $("#divLoader").toggle(false);
                    if (resultData.response == "Generated") {
                        swal(resultData.responseBody, { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    } else if (resultData.response == "Pending") {
                        swal(resultData.responseBody, { icon: "info" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                    else {
                        swal(resultData.responseBody, {icon: "warning"});
                    }
                },
                failure: function (error) {
                    $("#generateSummaryForm").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    swal(resultData.responseBody, { icon: "warning" });
                }
            });
        });

        var RiskResponseSummary = function (id) {
            debugger

           var url = '@Url.Action("GetRiskSummaryResponseData", "PlanningEngagement")';
           url += '?id=' + id;
           $("#addSummaryCommentData").show();
            $("#summaryCommentBody").load(url, function () {
                $("#summaryComment").modal({
                    backdrop: "static",
                    keyboard: false
                })
            });
        }

        $("#loadDataForMateriality").click(function () {
            debugger;

            var planningEngagementId = '@ViewBag.PlanningEngagementId';
            //var clientDataId = $("#ClientInformationIdx").val();
            //var clientFy = $("#FinancialYearName").val();

            var formdata = new FormData();
            formdata.append("__RequestVerificationToken", $('[name=__RequestVerificationToken]').val());
            formdata.append("PlanningEngagementId", planningEngagementId);
            //formdata.append("FinancialYearName", clientFy);


            for (const value of formdata.values()) {
                console.log(value);
            }

            var url = '@Url.Action("GenerateMaterialData", "PlanningEngagement")';
            $("#btnSaveAssignment").prop('disabled', true);
            $("#divLoader").toggle(true);

            $.ajax({
                url: url,
                data: formdata,
                type: 'POST',
                contentType: false,
                processData: false,
                success: function (resultData) {
                    $().prop('disabled', false);
                    $("#divLoader").toggle(false);
                    if (resultData.response == "Generated") {
                        swal(resultData.responseBody, { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    } else if (resultData.response == "Pending") {
                        swal(resultData.responseBody, { icon: "info" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                    else {
                        swal(resultData.responseBody, {icon: "warning"});
                    }
                },
                failure: function (error) {
                    $("#loadDataForMateriality").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    swal(error, { icon: "warning" });
                }
            });
        });


       $("#generatePerformanceMateriality").click(function () {
            debugger;

            var planningEngagementId = '@ViewBag.PlanningEngagementId';

            var formdata = new FormData();
            formdata.append("__RequestVerificationToken", $('[name=__RequestVerificationToken]').val());
            formdata.append("PlanningEngagementId", planningEngagementId);


            for (const value of formdata.values()) {
                console.log(value);
            }

            var url = '@Url.Action("SaveGeneratedPerformanceMaterialityPlan", "PlanningEngagement")';
            $("#btnSaveAssignment").prop('disabled', true);
            $("#divLoader").toggle(true);

            $.ajax({
                url: url,
                data: formdata,
                type: 'POST',
                contentType: false,
                processData: false,
                success: function (resultData) {
                    $().prop('disabled', false);
                    $("#divLoader").toggle(false);
                    if (resultData.response == "Generated") {
                        swal(resultData.responseBody, { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    } else if (resultData.response == "Pending") {
                        swal(resultData.responseBody, { icon: "info" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                    else {
                        swal(resultData.response, {icon: "warning"});
                    }
                },
                failure: function (error) {
                    $("#generateRiskPlanForm").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    swal(error, {icon:"warning"});
                }
            });
       });


        $("#revokePerformanceMateriality").click(function () {
            debugger;

            var planningEngagementId = '@ViewBag.PlanningEngagementId';

            var formdata = new FormData();
            formdata.append("__RequestVerificationToken", $('[name=__RequestVerificationToken]').val());
            formdata.append("PlanningEngagementId", planningEngagementId);


            for (const value of formdata.values()) {
                console.log(value);
            }

            var url = '@Url.Action("RevokeformanceMaterialityPlan", "PlanningEngagement")';
            $("#btnSaveAssignment").prop('disabled', true);
            $("#divLoader").toggle(true);

            $.ajax({
                url: url,
                data: formdata,
                type: 'POST',
                contentType: false,
                processData: false,
                success: function (response) {
                    $().prop('disabled', false);
                    $("#divLoader").toggle(false);
                    if (response == "Generated") {
                        swal("Performance Materiality has Be revoked Successfull", { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    } else if (response == "Pending") {
                        swal(responseBody, { icon: "info" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                    else {
                        swal(response, {icon: "warning"});
                    }
                },
                failure: function (error) {
                    $("#generateRiskPlanForm").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    swal(error, {icon:"warning"});
                }
            });
       });

        var PerformanceMateriality = function (id) {
            debugger

           var url = '@Url.Action("GetPerformanceMaterialityData", "PlanningEngagement")';
           url += '?id=' + id;
           $("#addperformanceData").show();
            $("#performanceBody").load(url, function () {
                $("#performance").modal({
                    backdrop: "static",
                    keyboard: false
                })
            });
        }

        function CalculateSampleSize() {
            debugger;
            //$("#divLoader").show();
            var planningEngagementId = '@ViewBag.PlanningEngagementId';
           var url = '@Url.Action("GetSampleSizeData", "PlanningEngagement")';
            url += '?id=' + planningEngagementId;
            //$("#SampleSizeModal").modal("show");
            $("#sampleBody").load(url,function () {
                     $("#sampleSizeId").modal({
                         backdrop: "static",
                         keyboard: false,
                     });
                     //$("#divLoader").hide();
                }
            );
        }


        function DeleteSample(id) {
            swal({
                title: "Are you sure?",
                text: "Once Remove, You will not be able to recover",
                buttons: ["Yes", "No"],
                closeOnClickOutside: false,
            }).then(function (isConfirm) {
                if (isConfirm) {
                    swal("Cancelled", "No change was made");
                } else {
                    RemoveSampleSize(id);
                }
            });
        }

        function RemoveSampleSize(id, index) {
            var params = { "id": id };
            var url = '@Url.Action("RemoveSelectedSample", "PlanningEngagement")';
            $.ajax({
                type: "get",
                url: url,
                data: params,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    if (response = "success") {
                        swal("Selected Sample Removed Successfully", { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                },
                failure: function (response) {
                    alert(response.d);
                }
            });
        }


         $("#generateTrendsMovement").click(function () {
            debugger;

            var planningEngagementId = '@ViewBag.PlanningEngagementId';
            var formdata = new FormData();
            formdata.append("__RequestVerificationToken", $('[name=__RequestVerificationToken]').val());
            formdata.append("PlanningEngagementId", planningEngagementId);


            for (const value of formdata.values()) {
                console.log(value);
            }

            var url = '@Url.Action("GeneratedTrendAnalysisMovement", "PlanningEngagement")';
            $("#btnSaveAssignment").prop('disabled', true);
            $("#divLoader").toggle(true);

            $.ajax({
                url: url,
                data: formdata,
                type: 'POST',
                contentType: false,
                processData: false,
                success: function (resultData) {
                    $().prop('disabled', false);
                    $("#divLoader").toggle(false);
                    if (resultData.response == "Generated") {
                        swal(resultData.responseBody, { icon: "success" })
                            .then((value) => {
                                window.location.reload();
                            });
                    } else if (resultData.response == "Pending") {
                        swal(resultData.responseBody, { icon: "info" })
                            .then((value) => {
                                window.location.reload();
                            });
                    }
                    else {
                        swal(resultData.response, {icon: "warning"});
                    }
                },
                failure: function (error) {
                    $("#generateTrendsMovement").prop('disabled', false);
                    $("#divLoader").toggle(false);
                    swal(error, {icon:"warning"});
                }
            });
        });

        @*var ReviewInternalControl = function (id) {
            debugger
            var engId = $("#EngagementId").val();
            var url = '@Url.Action("GetInternalControlData", "Engagement")';
            url += '?id=' + id + '&engId=' + engId;
           $("#reviewInternalControl").show();
            $("#modalReviewInternalControlBody").load(url, function () {
                $("#ReviewOfInternalControl").modal({
                    backdrop: "static",
                    keyboard: false
                })
            });
        }*@
    </script>
}
