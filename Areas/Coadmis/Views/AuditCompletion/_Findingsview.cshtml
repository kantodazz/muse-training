@model IEnumerable<IFMIS.Areas.Coadmis.DTO.FindingsTableVM>
<link href="~/Areas/Coadmis/Contents/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="~/Areas/Coadmis/Contents/css/rowGroup.dataTables.min.css" rel="stylesheet" />
<table id="example" class="display table table-bordered table-condensed table-striped" style="width:100%">
    <thead>
        <tr>
            <th>
                #
            </th>
            <th>
                Auditable Area
            </th>
            <th>
                Finding Name
            </th>
            <th>
                Management Response
            </th>
            <th>
                Auditor Comment
            </th>
            <th>
                Action
            </th>
        </tr>
    </thead>
    @{
        int i = 0;
    }
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @i
                </td>
                <td>
                    @item.FindingName
                </td>
                <td>
                    @item.AuditableAreaName
                </td>
                <td>
                    @item.ManagementResponse
                </td>
                <td>
                    @item.AuditorComment
                </td>
                <td>
                    <div class="btn-group">
                        <button type="button" class="btn btn-info btn-xs dropdown-toggle" data-toggle="dropdown" style="width:40px;border-radius:1px;" aria-haspopup="true" aria-expanded="false">
                            <span class="caret"></span>
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="#" onclick="viewFndingDetails(@item.ManagementAuditorCommentId)">
                                    <i class="glyphicon glyphicon-eye-open" aria-hidden="true" aria-hidden="true"></i>
                                    Details
                                </a>
                            </li>
                            <li>
                                <a href="#" onclick="editFndingDetails(@item.ManagementAuditorCommentId)">
                                    <i class="glyphicon glyphicon-pencil" aria-hidden="true" aria-hidden="true"></i>
                                    Edit
                                </a>
                            </li>
                            <li>
                                <a href="#" onclick="deleteFndingDetails(@item.ManagementAuditorCommentId)">
                                    <i class="glyphicon glyphicon-trash" aria-hidden="true" aria-hidden="true"></i>
                                    Cancel
                                </a>
                            </li>
                        </ul>
                    </div>
                </td>
            </tr>

        }
    </tbody>
</table>
<script src="~/Areas/Coadmis/Scripts/jquery.dataTables.min.js"></script>
<script src="~/Areas/Coadmis/Scripts/dataTables.rowGroup.min.js"></script>
<script>
    $(document).ready(function () {
        $("#divLoader").toggle(true);
        debugger

        var t = $('#example').DataTable({
            "columnDefs": [{
                "searchable": false,
                "orderable": false,
                "targets": 0
            }],
            "order": [[2, 'asc']]
            ,
            rowGroup: {
                dataSrc: [2]
            },
            columnDefs: [{
                targets: [2],
                visible: false
            }]
            , initComplete: function () {
                $("#divLoader").toggle(false);
            }
        });
        t.on('order.dt search.dt', function () {
            t.column(0, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
                cell.innerHTML = i + 1;
            });
        }).draw();

        
    });

    function viewFndingDetails(id) {
          debugger;
            $("#divLoader").show();
            var url = '@Url.Action("GetFindingDetails", "AuditCompletion")/' + id;

            $("#modal-body").load(url, function () {
                $("#modal").modal({
                    backdrop: "static",
                    keyboard: false
                });
                $("#divLoader").hide();
            });
    };

    function editFndingDetails(id) {
          debugger;
            $("#divLoader").show();
            var url = '@Url.Action("EditFindingDetails", "AuditCompletion")/' + id;

            $("#modal-body").load(url, function () {
                $("#modal").modal({
                    backdrop: "static",
                    keyboard: false
                });
                $("#divLoader").hide();
            });
    };

</script>