@model IEnumerable<IFMIS.Areas.IFMISTZ.Models.BankOutoStandingVw>

@{
    int i = 0;
    decimal? totalAmount = 0;
}

@{
    var groupKey = "";
}

<div class="well" style="padding-top:20px">
    <table style="width:50%">
        <tr>
            <td>
                <strong>ACCOUNT NUMBER:</strong>
                @Model.Select(a => a.BankAccount).FirstOrDefault()
            </td>
        </tr>
        <tr>
            <td>
                <strong>ACCOUNT NAME  :</strong>
                @Model.Select(a => a.AccountName).FirstOrDefault()
            </td>
        </tr>
    </table>
</div>

@foreach (var group in Model.GroupBy(a => a.TransactionType))
{
    if (group.Key.Trim() == "DR")
    {

        groupKey = "Payment";
    }
    else
    {
        groupKey = "Receipt";
    }
    <div class="group-header">
        @groupKey
    </div>

    <table class="table table-bordered table-condensed">

        <thead>
            <tr>
                <th>Date</th>
                <th style="width:4px">Bank Reference</th>
                <th style="width:4px">Related Reference</th>
                <th>Description</th>
                <th style="text-align:right;width:4px">Amount</th>
                <th style="width:2px">Age(Days)</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in group)
            {
                i++;
                totalAmount += item.Amount;
                <tr>
                    <td>@string.Format("{0: dd/MM/yyyy}", item.StatementDate)</td>
                    <td>@item.BankReference</td>
                    <td>@item.RelatedReference</td>
                    <td>@item.TransactionDescription</td>
                    <td style="text-align:right">@string.Format("{0:#,#.00;(#,#.00)}", item.Amount)</td>
                    <th>@item.Age</th>
                </tr>
            }
            <tr class="group-footer" style="background:#f5f5f5; color:#000000">
                <td colspan="4" style="text-align:right">Total</td>
                <td style="text-align:right">
                    @string.Format("{0:#,#.00;(#,#.00)}", group.Sum(x => x.Amount))
                </td>
                <td></td>
            </tr>
        </tbody>


    </table>
}

