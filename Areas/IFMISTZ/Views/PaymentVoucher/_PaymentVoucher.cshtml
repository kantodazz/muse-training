@model IFMIS.Areas.IFMISTZ.Models.PaymentVoucher
@{
    Layout = null;
}
<style>
    @@page {
        size: A4;
        margin: 1cm;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 12px;
        color: #000;
    }

    .header {
        text-align: center;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .section-title {
        text-align: center;
        font-weight: bold;
        margin-top: 15px;
        /*text-decoration: underline;*/
    }

    .info-table, .amount-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        font-size: 12px;
    }

        .info-table td {
            padding: 4px;
            vertical-align: top;
        }

        .amount-table th, .amount-table td {
            border: 1px solid #000;
            padding: 6px;
            text-align: left;
            font-size: 12px;
        }

    .signature-block {
        margin-top: 40px;
    }

    .signature-line {
        border-bottom: 1px solid #000;
        height: 30px;
        width: 100%;
        margin-top: 10px;
    }

    .label {
        font-weight: bold;
        width: 160px;
    }

    .value {
        font-weight: normal;
    }
</style>

<!-- Header -->
<div class="header">THE UNITED REPUBLIC OF TANZANIA</div>
@*<div class="header"><img src="@ViewBag.logoImageBase64" alt="Logo" style="width:100px;height:100px"></div>*@
<div style="position: relative; text-align: center; margin-bottom: 10px;">
    <!-- Logo exactly centered -->
    <img src="@ViewBag.logoImageBase64" alt="Logo" style="width: 100px; height: 100px;">

    <!-- TFN text on the right of logo, without affecting its centering -->
    <div style="
        position: absolute;
        top: 0;
        left: 90%;
        transform: translateX(70px); /* Adjust distance from logo */
        font-size: 12px;
        text-align: left;
    ">
        TFN. 4<br />
        REV. 3/74
    </div>
</div>
@*<div class="header" style="display: flex; justify-content: space-between; align-items: center;">
    <img src="@ViewBag.logoImageBase64" alt="Logo" style="width:100px;height:100px">
    <div style="text-align: right; font-size: 12px; font-weight: normal;">
        TFN. 4<br />
        REV. 3/74
    </div>
</div>*@
<div class="header">REGIONAL ADMIN AND LOCAL GOVERNMENT</div>
<div class="header">@Model.InstitutionCode - @Model.InstitutionName</div>

<div class="section-title">PAYMENT VOUCHER</div>

<!-- Voucher Details -->
<table style="width: 100%; margin-top: 20px;">
    <tr style="font-size: 12px;">
        <td style="text-align: left; font-weight: bold;">
            Station No:  @Model.PaystationId
        </td>
        <td style="text-align: right; font-weight: bold;">
            PV No: @Model.PVNo
        </td>
    </tr>
</table>

<!-- Payee Information Box -->
<div style="border: 1px solid #000; padding: 10px; margin-top: 20px;">
    <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
        <tr>
            <td style="font-weight: bold; width: 15%;">Payee's Name</td>
            <td colspan="3">: @(Model.Payeename ?? "NA")</td>
        </tr>
        <tr>
            <td style="font-weight: bold;">Account Name</td>
            <td colspan="3">: @(Model.PayeeAccountName ?? "NA")</td>
        </tr>
        <tr>
            <td style="font-weight: bold;">Payee's Code</td>
            <td colspan="3">: @(Model.PayeeCode ?? "NA")</td>
        </tr>
        <tr>
            <td style="font-weight: bold;">Address</td>
            <td colspan="3">: @(Model.PayeeAddress ?? "NA")</td>
        </tr>
        <tr>
            <!-- VRN on the left -->
            <td style="font-weight: bold;">VRN</td>
            <td style="width: 50%;">: @Model.VATOnGoods</td>

            <!-- TIN on the right -->
            <td style="font-weight: bold; width: 15%;">TIN</td>
            <td style="text-align: left;">: @(Model.PayeeCode ?? "NA")</td>
        </tr>
    </table>
</div>

<br />
<div style="width: 100%; margin-top: 20px; display: flex; gap: 20px;">
    <!-- LEFT SIDE -->
    <div style="width: 40%;">
        <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
            <tr>
                <td style="font-weight: bold; width: 40%;">Payment in Respect of:</td>
            </tr>
            <tr>
                <td style="line-height: 1.5em; min-height: 60px; padding: 5px 0;">
                 @Model.PaymentDesc</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">To be Paid From:</td>
            </tr>
            <tr>
                <td>@Model.PayerBankAccountName</td>
            </tr>
        </table>
    </div>

    <!-- RIGHT SIDE BOX -->
    <div style="width: 50%; border: 1px solid #000; padding: 10px;">
        <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
            <tr>
                <td style="font-weight: bold; width: 45%;">Apply Date:</td>
                <td>: @Convert.ToDateTime(Model.ApplyDate).ToString("dd MMMM yyyy")</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Reference No:</td>
                <td>: @(Model.DfundApprovalRef ?? "NA")</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Source Module:</td>
                <td>: @(Model.SourceModule ?? "NA")</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Invoice No:</td>
                <td>: @(Model.InvoiceNo ?? "NA")</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Invoice Date:</td>
                <td>: @Convert.ToDateTime(Model.InvoiceDate).ToString("dd MMMM yyyy")</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Voucher Classification:</td>
                <td>: @(Model.SubBudgetClass ?? "NA")</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Terms of Payment:</td>
                <td>: @(Model.PaymentTerms ?? "NA")</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Payment Method:</td>
                <td>: @(Model.PaymentMethod ?? "NA")</td>
            </tr>
        </table>
    </div>
</div>

<br />
<!-- ACCOUNT ENTRIES Heading -->
<div style="text-align: center; font-weight: bold; margin-top: 30px;">ACCOUNT ENTRIES</div>

<!-- Amount Table -->
<table class="amount-table" style="margin-top: 15px;">
    <thead>
        <tr>
            <th style="width: 40%;">Account Code</th>
            <th style="width: 40%;">Account Description</th>
            <th style="width: 20%; text-align: right;">Amount</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>@Model.PayerCashAccount</td>
            <td>@Model.PayerCashAccountGfsCodeDesc</td>
            <td style="text-align: right;">@string.Format("{0:#,0.00}", Model.BaseAmount)</td>
        </tr>
        <tr>
            <td style="border: none;"></td>
            <td>NET AMOUNT:</td>
            <td style="text-align: right;">@string.Format("{0:#,0.00}", Model.BaseAmount)</td>
        </tr>
    </tbody>
</table>


<!-- AUTHORITY Label -->
<div style="font-weight: bold; margin-top: 30px;">AUTHORITY:</div>

<!-- Full-width line -->
<div style="border-bottom: 1px solid #000; width: 100%; margin: 5px 0 15px 0;"></div>

<!-- Certification Text -->
<p style="margin-top: 10px; text-align: justify;">
    I certify that the above sum of TZS (@string.Format("{0:#,0.00}", Model.BaseAmount)) is correctly payable to the above-named person and that
    the rates of payment/prices are in accordance with Regulations/the Terms of the Contract and that the funds are available
    under the Sub-Vote and Item quoted above to meet this payment.
</p>

<br />
<br />
<!-- Signature Section -->
<div class="signature-block">
    <table style="width: 100%;">
        <tr>
            <td style="width: 33%;">
                <div>OriginatingOfficer</div>
            </td>
            <td style="width: 33%;text-align:left;padding-left:20px">
                <div>ExaminingOfficer</div>
            </td>
            <td style="width: 33%; text-align: left; padding-left: 20px">
                <div>AuthorizingOfficer</div>
            </td>
        </tr>
    </table>
</div>
<br />
<br />
<br />
<br />
<br />
<!-- Full-width line -->
<div style="border-bottom: 1px solid #000; width: 100%; margin: 5px 0 15px 0;"></div>


<!-- Footer -->

<table style="width: 100%; margin-top: 30px; font-size: 11px;">
    <tr>
        <td style="text-align: left;">Mfumo wa Ulipaji Serikalini [MUSE]</td>
    </tr>
</table>
