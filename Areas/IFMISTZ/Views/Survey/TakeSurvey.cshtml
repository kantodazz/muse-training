@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUSE Survey Form</title>
    <style>
        .center-item {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .paper {
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 2% 8%;
        }

        .btn {
            background-color: deepskyblue;
            color: white;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
        }

        .question {
            margin-bottom: 20px;
        }

        .error {
            color: red;
            font-size: 0.9em;
            margin-top: 4px;
        }
    </style>
</head>

<body>
    <div style="padding:3% 15%;">
        <div class="paper">
            <div class="center-item">
                <p style="font-weight: bold">MFUMO WA UHASIBU SERIKALINI (MUSE)</p>
            </div>
            <div class="center-item">
                <p style="font-weight: bold">Dodoso la kupata maoni ya watumiaji kwa ajili ya kuboresha mfumo</p>
            </div>
            <hr style="border: 1px solid #000000;margin-bottom: 20px" />
            <div>
                <strong> Utangulizi:</strong>
            </div>
            <div class="center-item">
                <div>
                    <p>
                        Mpendwa Mtumiaji wa MUSE,
                        Asante kwa kuchukua muda wako kutoa maoni kuhusu mfumo wetu. Maoni yako ni muhimu kwetu na yatatusaidia kuboresha huduma zetu. Kujaza dodoso hili kutachukua si zaidi ya dakika kumi (10).
                    </p>
                </div>
            </div>
            <p>
                <strong> Maswali:</strong>
            </p>
            <form id="surveyForm">
                <div class="question">
                    <div>1. Mfumo ni rahisi kiasi gani kutumia?</div>
                    <div style="font-style: italic">(Tafadhali pima kwa kiwango cha 1 hadi 5, ambapo 1 ni ngumu sana na 5 ni rahisi sana.)</div>
                    <ol>
                        <li><input type="radio" name="question1" /> Ngumu Sana</li>
                        <li><input type="radio" name="question1" /> Ngumu</li>
                        <li><input type="radio" name="question1" /> Wastani</li>
                        <li><input type="radio" name="question1" /> Rahisi</li>
                        <li><input type="radio" name="question1" /> Rahisi Sana</li>
                    </ol>
                    <div class="error" id="errorQuestion1"></div>
                </div>
                <div class="question">
                    <div>2. Una maoni gani kuhusu upatikanaji wa mfumo?</div>
                    <div style="font-style: italic">(Tafadhali chagua chaguo moja linaloeleza uzoefu wako vizuri.)</div>
                    <ol>
                        <li><input type="radio" name="question2" /> Daima unapatikana</li>
                        <li><input type="radio" name="question2" /> Mara nyingi unapatikana, lakini kuna nyakati chache haupatikani</li>
                        <li><input type="radio" name="question2" /> Mfumo unapatikana mara chache, muda mwingi haupatikani</li>
                        <li><input type="radio" name="question2" /> Mfumo haupatikani kabisa</li>
                    </ol>
                    <div class="error" id="errorQuestion2"></div>
                </div>
                <div class="question">
                    <div>3. Ni changamoto gani unakumbana nazo wakati wa kutumia mfumo?</div>
                    <div style="font-style: italic">(Tafadhali eleza changamoto zozote unazokutana nazo na moduli inayohusika)</div>
                    <div style="padding: 8px">
                        Mfano:
                        Ripoti - Ripoti ya itemized inatumia muda mrefu kufunguka
                    </div>
                    <div>
                        <textarea rows="5" style="width: 100%" name="question3"></textarea>
                    </div>
                    <div class="error" id="errorQuestion3"></div>
                </div>
                <div class="question">
                    <div>4. Ungependa kuona maboresho yapi yakifanyika kwenye mfumo?</div>
                    <div style="font-style: italic">(Tafadhali orodhesha maeneo unayodhani yanaweza kuboreshwa na aina ya maboresho yanayotakiwa)</div>
                    <div style="padding: 8px">
                        Mfano:
                        Payment - Mtumiaji awezeshwe kusaini “payment slip” kidigitali
                    </div>
                    <div>
                        <textarea rows="5" style="width: 100%" name="question4"></textarea>
                    </div>
                    <div class="error" id="errorQuestion4"></div>
                </div>
                <div class="question">
                    <div>5. Unatumia njia gani kupata msaada wa kitaalam pindi unapokumbana na changamoto kwenye mfumo?</div>
                    <div style="font-style: italic">(Chagua zote zinazotumika.)</div>
                    <ol>
                        <li><input type="checkbox" name="question5.1" /> Barua pepe ya dawati la msaada/wataalam MUSE</li>
                        <li><input type="checkbox" name="question5.2" /> Msaada wa simu kwa wataalam wa MUSE</li>
                        <li><input type="checkbox" name="question5.3" /> Mwongozo wa mtumiaji/ User manual</li>
                        <li><input type="checkbox" name="question5.4" /> Kikundi cha WhatsApp chenye wataalam wa MUSE</li>
                        <li><input type="checkbox" name="question5.5" /> Nyinginezo</li>
                    </ol>
                    <div class="error" id="errorQuestion5"></div>
                </div>
                <div class="question">
                    <div>6. Je ukiwasilisha changamoto unapata msaada kwa wakati?</div>
                    <div style="font-style: italic">(Chagua inayohusika)</div>
                    <ol>
                        <li><input type="radio" name="question6" /> Daima Napata msaada kwa wakati</li>
                        <li><input type="radio" name="question6" /> Mara nyingi napata msaada, lakini kuna nyakati nachelewa kupata msaada</li>
                        <li><input type="radio" name="question6" /> Mara chache Napata msaada ila muda mwingi sipati msaada</li>
                        <li><input type="radio" name="question6" /> Sipati msaada kabisa</li>
                    </ol>
                    <div class="error" id="errorQuestion6"></div>
                </div>
                <div class="question">
                    <div>7. Kwa maoni yako, nini kifanyike ili kuboresha utaratibu wa kukupatia msaada?</div>
                    <div style="font-style: italic">(Tafadhali toa maoni yako kuhusu njia za kuboresha utaratibu wa kutoa msaada wa kitaalam)</div>
                    <div>
                        <textarea rows="5" style="width: 100%" name="question7"></textarea>
                    </div>
                    <div class="error" id="errorQuestion7"></div>
                </div>
                <div class="question">
                    <div>8. Una maoni yeyote ya ziada kuhusu mfumo wa MUSE?</div>
                    <div style="font-style: italic">(Tafadhali toa maoni mengine yoyote unayofikiri ni muhimu.)</div>
                    <div>
                        <textarea rows="5" style="width: 100%" name="question8"></textarea>
                    </div>
                    <div class="error" id="errorQuestion8"></div>
                </div>
                <div style="padding: 8px; display: flex; justify-content: flex-end">
                    <button type="submit" class="btn" id="submit">WASILISHA</button>
                </div>
            </form>
        </div>
    </div>
    <script src="~/Scripts/swal/sweetalert.min.js"></script>
    <script>
        document.getElementById("surveyForm").addEventListener("submit", function (event) {
            event.preventDefault(); // Prevent the default form submission

            // Clear previous error messages
            document.querySelectorAll(".error").forEach(function (el) {
                el.textContent = "";
            });

            let isValid = true;

            // Validate each question
            for (let i = 1; i <= 8; i++) {
                const questionName = "question" + i;
                const question = document.getElementsByName(questionName);
                let errorElement = document.getElementById("errorQuestion" + i);

                if (question.length > 1) { // Radio buttons or checkboxes
                    let isAnswered = Array.from(question).some((input) => input.checked);
                    if (!isAnswered) {
                        errorElement.textContent = "Tafadhali jibu swali hili.";
                        isValid = false;
                    }
                } else if (question[0]?.type === "textarea" && question[0]?.value.trim() === "") {
                    errorElement.textContent = "Tafadhali jibu swali hili.";
                    isValid = false;
                }
            }

            if (isValid) {
                // Gather form data
                var formData = new FormData(document.getElementById("surveyForm"));

                formData.set('IsAnonymous', '@ViewBag.IsAnonymous' === 'true')
                document.querySelectorAll('input[type="radio"]:checked').forEach(function (radio) {
                    const name = radio.name;
                    const labelText = radio.parentElement.textContent.trim();
                    formData.set(name, labelText); // Set the formData entry with the label text
                });
                var question5 = "";
                document.querySelectorAll('input[type="checkbox"]:checked').forEach(function (checkbox) {
                    const labelText = checkbox.parentElement.textContent.trim();
                    question5 += `${labelText},`
                });
                formData.set('question5', question5);
                document.getElementById("submit").disabled = true;
                document.getElementById("submit").textContent = "TUNA WASILISHA, TAFADHALI SUBIRI...";
                // Example AJAX request using Fetch API
                fetch('@Url.Action("SubmitSurvey", "Survey")', {
                    method: 'POST',
                    body: formData
                }).then(response => {
                    swal("Asante kwa kutoa maoni yako!")
                        .then(_ => {
                            window.location.href = `${window.location.origin}/?skip=1`;
                        })
                });
            }
        });
    </script>
</body>

</html>
