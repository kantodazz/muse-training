@model IFMIS.Areas.IFMISTZ.Models.ChangeRetentionPayeeVM
@{
    ViewBag.Title = "Ceiling Details";
    var i = 0;


}
<style>
    .pull-right {
        margin-top: 10px;
    }

    ul .header-dropdown-list, .hidden-xs {
        margin-top: 10px;
    }
</style>
<div id="content">

    <!-- widget grid -->
    <section id="widget-grid">


        <!-- START ROW -->

        <div>

            <!-- NEW COL START -->
            <article class="col-sm-12 col-md-12 col-lg-12">

                <!-- Widget ID (each widget will need unique ID)-->
                <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false" data-widget-custombutton="false" data-widget-colorbutton="false" data-widget-deletebutton="false" data-widget-togglebutton="false">

                    <header class="margin-top-10">
                        <span class="widget-icon"> <i class="fa fa-edit"></i> </span>
                        <h2>Ceiling Details </h2>

                    </header>


                    <div>

                        <div class="widget-body">
                            <div align="center">
                                <img src="~/Media/Images/ajax_loader.gif" class="loadingImg" style="display:none" />
                            </div>
                            <div class="row mx-1 fs-3">
                                <div class="col-md-8 py-5">
                                    <div class="row py-2">
                                        <div class="control-label col-sm-12  col-md-4 col-lg-3 fw-bold ">Contract Name</div>
                                        <div class="col-sm-12 col-md-8 col-lg-9">
                                            <span style="font-weight:bold">:</span>  @Html.DisplayFor(model => model.ContractNumber)
                                        </div>
                                    </div>

                                    <div class="row py-2">
                                        <div class="control-label col-sm-12  col-md-4 col-lg-3 fw-bold ">Payee Name</div>
                                        <div class="col-sm-12 col-md-8 col-lg-9">
                                            <span style="font-weight:bold">:</span>  @Html.DisplayFor(model => model.PayeeName)
                                        </div>
                                    </div>


                                    <div class="row py-2">
                                        <div class="control-label col-sm-12  col-md-4 col-lg-3 fw-bold ">Payee Code</div>
                                        <div class="col-sm-12 col-md-8 col-lg-9">
                                            <span style="font-weight:bold">:</span>  @Html.DisplayFor(model => model.PayeeCode)
                                        </div>
                                    </div>

                                    <hr />

                                    <div class="row py-2">
                                        <div class="control-label col-sm-12  col-md-4 col-lg-3 fw-bold ">New Payee Name</div>
                                        <div class="col-sm-12 col-md-8 col-lg-9">
                                            <span style="font-weight:bold">:</span>  @Html.DisplayFor(model => model.NewPayeeName)
                                        </div>
                                    </div>

                                    <div class="row py-2">
                                        <div class="control-label col-sm-12  col-md-4 col-lg-3 fw-bold ">New Payee Code</div>
                                        <div class="col-sm-12 col-md-8 col-lg-9">
                                            <span style="font-weight:bold">:</span>  @Html.DisplayFor(model => model.NewPayeeCode)
                                        </div>
                                    </div>


                                    <div class="row py-2">
                                        <div class="control-label col-sm-12  col-md-4 col-lg-3 fw-bold ">Retention Amount</div>
                                        <div class="col-sm-12 col-md-8 col-lg-9">
                                            <span style="font-weight:bold">:</span>  @Html.DisplayFor(model => model.Balance)
                                            <span>@Html.DisplayFor(model => model.currency)</span>
                                        </div>
                                    </div>


                                    <div class="row py-2">
                                        <div class="control-label col-sm-12  col-md-4 col-lg-3 fw-bold ">Retention Amount</div>
                                        <div class="col-sm-12 col-md-8 col-lg-9">
                                            <span style="font-weight:bold">:</span>  @Html.DisplayFor(model => model.PayeeBankName)
                                        </div>
                                    </div>


                                    <div class="row py-2">
                                        <div class="control-label col-sm-12  col-md-4 col-lg-3 fw-bold ">Bank Account</div>
                                        <div class="col-sm-12 col-md-8 col-lg-9">
                                            <span style="font-weight:bold">:</span>  @Html.DisplayFor(model => model.PayeeBankAccount)
                                        </div>
                                    </div>


                                    <div class="row py-2">
                                        <div class="control-label col-sm-12  col-md-4 col-lg-3 fw-bold ">Payee Address</div>
                                        <div class="col-sm-12 col-md-8 col-lg-9">
                                            <span style="font-weight:bold">:</span>  @Html.DisplayFor(model => model.PayeeAddress)
                                        </div>
                                    </div>

                                    <div class="row py-2">
                                        <div class="control-label col-sm-12  col-md-4 col-lg-3 fw-bold ">Payee Type</div>
                                        <div class="col-sm-12 col-md-8 col-lg-9">
                                            <span style="font-weight:bold">:</span>  @Html.DisplayFor(model => model.PayeeType)
                                        </div>
                                    </div>


                                    <div class="row py-2">
                                        <div class="control-label col-sm-12  col-md-4 col-lg-3 fw-bold ">Payee Bic</div>
                                        <div class="col-sm-12 col-md-8 col-lg-9">
                                            <span style="font-weight:bold">:</span>  @Html.DisplayFor(model => model.PayeeBIC)
                                        </div>
                                    </div>

                                </div>

                            </div>
                            <hr />
                            <div class="row">
                                <div class="col-md-offset-1">
                                    <a href="@Url.Action("ApprovalRetentionPayee","ChangeRetentionPayee")" class="btn btn-info"><i class="glyphicon glyphicon-arrow-left"></i> Back  </a>

                                    <button type="button" onclick="ApproveEntry(@Model.ChangeRetentionPayeeId)" class="btn btn-info">
                                        <i class="glyphicon glyphicon-floppy-disk"></i> Approve
                                    </button>

                                    <button type="button" onclick="cancelConfirmedEntry(@Model.ChangeRetentionPayeeId)" class="btn btn-info">
                                        <i class="glyphicon glyphicon-floppy-disk"></i> Reject
                                    </button>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>

        </div>
    </section>

</div>
@section pagespecific {
    <script>


      
         function cancelConfirmedEntry (id) {
            swal({
                title: 'Confirmation',
                text: "Do you what to cancel this entry ?",
                buttons: ['No','Yes'],}).then(function (isConfirm) {
                        if (isConfirm) {
                            var url = '@Url.Action("CancelEntry", "ChangeRetentionPayee")';
                            $.ajax({
                                type: "POST",
                                url: url,
                                data: { id: id },
                                success: function (response) {
                                    if (response == "Success") {
                                        swal("Cancelled  successfully!", { icon: "success" })
                                         .then((value) => {
                                              var url = '@Url.Action("ApprovalRetentionPayee", "ChangeRetentionPayee")';
                                window.location.replace(url);
                                         });
                                    }
                                    else {
                                        alert(response);
                                    }
                                },
                                error: function (xhr) {
                                    swal("An error has occured, contact system support");
                                },
                            });
                        } else {
                            swal("Cancelled", "No change was made");
                    }
                });
        };



        function ApproveEntry (id) {
            swal({
                title: 'Confirmation',
                text: "Do you want to Approve this entry",
                buttons: ['No', 'Yes'],
            }).then(function (isConfirm) {
                if (isConfirm) {
                    var url = '@Url.Action("ApproveEntry", "ChangeRetentionPayee")';
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: { id: id },
                        success: function (response) {
                            if (response == "Success") {
                                swal("Approved successfully!", { icon: "success" })
                                    .then((value) => {
                                         var url = '@Url.Action("ApprovalRetentionPayee", "ChangeRetentionPayee")';
                                window.location.replace(url);
                                    });
                            } else {
                                swal(response);
                            }
                        },
                        error: function (xhr) {
                            swal(error);
                            $("#divLoader").hide();
                        },
                    });
                } else {
                    swal("Cancelled", "No change was made");
                }
            });
        };


    </script>
}


